START:
  DIM PAR%(20000)
  DIM PBR%(20000)
  DIM PCR%(20000)
   CLS
   ARA=0
   PS=15
   PO=30
   KZ=15
   DIR$="UPGRADE"
   SCREEN 9
   LINE (7, 7)-(630, 7)
   LINE (630, 7)-(630, 335)
   LINE (630, 335)-(7, 335)
   LINE (7, 335)-(7, 7)
   LINE (7, 30)-(630, 30)
   LOCATE 2, 2
   COLOR 2
   PRINT " л                 лллллллллллллллллллллллллллллллллллллллллллллллллллллл"
   COLOR 3
   LOCATE 2, 4
   PRINT "Upgrade graphic editor"
   LINE (600, 7)-(600, 30)
   LINE (602, 28)-(628, 9)
   LINE (602, 9)-(628, 28)
BEGINSUB:
   LINE (9,32)-(628,32)
   LINE (628,32)-(628,57)
   LINE (628,57)-(9,57)
   LINE (9,57)-(9,32)
   COLOR 14
   LOCATE 4,3
   PRINT"(N)ew                (L)oad                   (H)elp                 (Q)uit"
   COLOR 5
OFFA:
   LOCATE 23,2
   LET Z$=INKEY$
   IF ARA=200000 THEN GOTO BLANK
   IF Z$="N" OR Z$="n" THEN ARA=0:GOTO NEW
   IF Z$="H" OR Z$="h" THEN ARA=0:GOTO HELPA
   IF Z$="Q" OR Z$="q" THEN ARA=0:SYSTEM:END
   IF Z$="L" OR Z$="l" THEN ARA=0:GOTO LOADA
   LET ARA=ARA+1
   GOTO OFFA
   END
HELPA:
   CLS
   SCREEN 9
   LINE (7, 7)-(630, 7)
   LINE (630, 7)-(630, 335)
   LINE (630, 335)-(7, 335)
   LINE (7, 335)-(7, 7)
   LINE (7, 30)-(630, 30)
   LOCATE 2, 2
   COLOR 2
   PRINT " л                 лллллллллллллллллллллллллллллллллллллллллллллллллллллл"
   COLOR 3
   LOCATE 2, 4
   PRINT "Upgrade graphic editor"
   LINE (600, 7)-(600, 30)
   LINE (602, 28)-(628, 9)
   LINE (602, 9)-(628, 28)
'BEGIN
   COLOR 8
   LOCATE 4,2
   PRINT"                                   HELP!"
   COLOR 3
   LOCATE 5,2
   PRINT"This is a modified graphic editor. It is more powerful"
   LOCATE 6,2
   PRINT"than previos versions."
   COLOR 5
   LOCATE 8,2
   PRINT"Keys:"
   COLOR 4
   LOCATE 10,2
   LOCATE 9,2
   PRINT" NUM PAD  |  KEYBOARD"
   LOCATE 10,2
   PRINT"  7 8 9   |   E Q M"
   LOCATE 11,2
   PRINT"  4 5 6   |   P C H T"
   LOCATE 12,2
   PRINT"  1 2 3   |   B S L N"
   LOCATE 13,2
   PRINT"WARNING! Num lock AND Caps lock MUST BE ON"
   LOCATE 14,2
   PRINT""
   LOCATE 15,2
   PRINT"USE THE Num pad TO NAVIGATE THE CURSOR AND DRAW"
   LOCATE 16,2
   PRINT"FOLLOWING KEYS ARE VERY IMPORTANT IF YOU LIKE TO DRAW BEAUTIFUL PICTURES:"
   DO
   LOOP WHILE INKEY$=""
   CLS
   SCREEN 9
   LINE (7, 7)-(630, 7)
   LINE (630, 7)-(630, 335)
   LINE (630, 335)-(7, 335)
   LINE (7, 335)-(7, 7)
   LINE (7, 30)-(630, 30)
   LOCATE 2, 2
   COLOR 2
   PRINT " л                 лллллллллллллллллллллллллллллллллллллллллллллллллллллл"
   COLOR 3
   LOCATE 2, 4
   PRINT "Upgrade graphic editor"
   LINE (600, 7)-(600, 30)
   LINE (602, 28)-(628, 9)
   LINE (602, 9)-(628, 28)
   COLOR 6
   LOCATE 4,3
   PRINT"5-COLOR (PRESS 5 ON NUMPAD AND CHOSE COLOR)"
   LOCATE 5,3
   PRINT"E-ERASER (PRESS E AND WITH THE HELP OF NUMPAD ERASE SOMETHING)"
   LOCATE 6,3
   PRINT"P-PAINT (PRESS P AND NAVIGATE THE POINT, PRESS P AGAIN TO CHOSE"
   LOCATE 7,3
   PRINT"THE COLOR OF PAINT, AFTER THAT PRESS ESC)"
   LOCATE 8,3
   PRINT"B-BRUSH (PRESS B AND DRAW WITH THE BRUSH, PRESS B AGAIN AND CHOSE"
   LOCATE 9,3
   PRINT"THE SIZE OF YOUR BRUSH, PRESS 5 AND CHOSE THE COLOR, PRESS ESC TO STOP)"
   LOCATE 10,3
   PRINT"Q-SQUARE BRUSH (PRESS Q AND DRAW, PRESS Q AGAIN TO CHOSE SIZE, PRESS"
   LOCATE 11,3
   PRINT"5 TO CHOSE COLOR, PRESS ESC TO FINISH)"
   LOCATE 12,3
   PRINT"C-CIRCLE (PRESS C AND NAVIGATE THE POINT, USE NUMPAD TO MODIFY IT)"
   LOCATE 13,3
   PRINT"PRESS C AGAIN TO CHOSE COLOR, ESC TO FINISH."
   LOCATE 14,3
   PRINT"S-CLEAR SCREEN (PRESS S AND YOU WILL CLEAN THE SCREEN)"
   LOCATE 15,3
   PRINT"M-RESOLUTION (PRESS M UNTIL YOU FIND RESOLUTION YOU LIKE BEST."
   LOCATE 16,3
   PRINT"NOTE: THE SCREEN WILL CLEAN AUTOMATICLY)"
   LOCATE 17,3
   PRINT"H-HELP (DISPLAYS QUICK HELP)"
   LOCATE 18,3
   PRINT"L-LINE (PRESS L AND NAVIGATE THE LINE, PRESS L AGAIN TO CHANGE COLOR"
   LOCATE 19,3
   PRINT"PRESS ESC TO STOP)"
   LOCATE 20,3
   PRINT"T-TEXT PASTE (PRESS T AND NAVIGATE THE CURSOR, PRESS 5 TO CHANGE COLOR"
   LOCATE 21,3
   PRINT"PRESS T AGAIN TO WRITE, PRESS ENTER WHEN DONE) NOTE:CURSOR COLOR=TEXT COLOR"
   LOCATE 22,3
   PRINT"PLUS YOU CAN PRESS ESC ANY TIME AND CANCEL TEXT PASTE"
   LOCATE 23,3
   PRINT"N-NO DRAW (MOVES CURSOR WITHOUT DRAWING)"
   DO
   LOOP WHILE INKEY$=""
   CLS
   SCREEN 9
   LINE (7, 7)-(630, 7)
   LINE (630, 7)-(630, 335)
   LINE (630, 335)-(7, 335)
   LINE (7, 335)-(7, 7)
   LINE (7, 30)-(630, 30)
   LOCATE 2, 2
   COLOR 2
   PRINT " л                 лллллллллллллллллллллллллллллллллллллллллллллллллллллл"
   COLOR 3
   LOCATE 2, 4
   PRINT "Upgrade graphic editor"
   LINE (600, 7)-(600, 30)
   LINE (602, 28)-(628, 9)
   LINE (602, 9)-(628, 28)
'CONTINUE
   COLOR 10
   LOCATE 4,3
   PRINT"ALL THE INFORMATION YOU NEED YOU'LL FIND AT THE TOP OF THE LIST:"
   LOCATE 5,3
   COLOR 11
   PRINT"Draw type        - THIS ITEM SHOWS THE DRAW TYPE LIKE 'BRUSH' OR 'PAINT'"
   LOCATE 6,3
   PRINT"Line color       - THIS ITEM SHOWS THE CURRENT COLOR LIKE 'WHITE' OR 'GREEN'"
   LOCATE 7,3
   PRINT"WARNING! THIS ITEM SHOWS ONLY THE TYPE OF THE COLOR, NOT IT'S CURRENT HUE"
   LOCATE 8,3
   PRINT"Coordinates(X,Y) - THIS ITEM SHOWS CURRENT COORDINATES OF YOUR POINT"
   LOCATE 9,3
   PRINT"LIKE 320;219"
   COLOR 9
   PRINT
   LOCATE 11,3
   PRINT"ALL THE QUESTIONS ARE AT THE TOP TOO"
   LOCATE 12,3
   PRINT"AND IF YOU WANT TO STOP DRAWING, PRESS ESC"
   COLOR 4
   LOCATE 15,3
   PRINT"Enjoy this program and PRESS ANY KEY now"
   DO
   LOOP WHILE INKEY$=""
   GOTO START
   END
NEW:
  CLS
  SCREEN 9
CLAM:
  X=320
  Y=200
  LET CR$="WHITE"
  LET A=15
  T$="DRAW"
SET:
  LINE(1,1)-(639,349),15,B
  LINE(3,3)-(637,50),15,B
  LINE(320,3)-(320,50),15
DRAWA:
  COLOR 14
  LOCATE 2,42
  PRINT"Line color:";CR$
  LOCATE 3,42
  PRINT"Coordinate X:";X
  LOCATE 3,60
  PRINT"Coordinate Y:";Y
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:DRAW      "
  LOCATE 3,2
  COLOR 0
  PRINT"                        "
  LET A$=INKEY$
  IF A$="6" THEN X=X+1
  IF A$="4" THEN X=X-1
  IF A$="8" THEN Y=Y-1
  IF A$="2" THEN Y=Y+1
  IF A$="9" THEN X=X+1:Y=Y-1
  IF A$="7" THEN X=X-1:Y=Y-1
  IF A$="1" THEN X=X-1:Y=Y+1
  IF A$="3" THEN X=X+1:Y=Y+1
  IF A$="5" THEN GOTO CLR
  IF A$="E" THEN GOTO ERASEA
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="L" THEN GOTO LIN
  IF A$="T" THEN GOTO TEXT
  IF A$="N" THEN GOTO NODRAW
  IF A$=CHR$(27) THEN GOTO ASKME
  PSET(X,Y),A
  GOTO DRAWA
  END
CLR:
  COLOR 6
  LOCATE 3,2
  INPUT"Enter color(0-15):";A
  IF A>15 THEN A=15:CR$="WHITE":GOTO DRAWA
  IF A=0 THEN CR$="BLACK"
  IF A=1 OR A=9 OR A=3 OR A=11 THEN CR$="BLUE"
  IF A=2 OR A=10 THEN CR$="GREEN"
  IF A=4 THEN CR$="RED"
  IF A=5 THEN CR$="PURPLE"
  IF A=13 OR A=12 THEN CR$="PINK"
  IF A=6 THEN CR$="ORANGE"
  IF A=7 OR A=8 THEN CR$="GREY"
  IF A=14 THEN CR$="YELLOW"
  IF A=15 THEN CR$="WHITE"
  LOCATE 2,42
  PRINT"                        "
  GOTO DRAWA
  END
ERASEA:
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:ERASE      "
  LINE(X-8,Y-8)-(X+8,Y+8),0,BF
  LET A$=INKEY$
  IF A$="6" THEN X=X+3
  IF A$="4" THEN X=X-3
  IF A$="8" THEN Y=Y-3
  IF A$="2" THEN Y=Y+3
  IF A$="9" THEN X=X+3:Y=Y-3
  IF A$="7" THEN X=X-3:Y=Y-3
  IF A$="1" THEN X=X-3:Y=Y+3
  IF A$="3" THEN X=X+3:Y=Y+3
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="L" THEN GOTO LIN
  IF A$="T" THEN GOTO TEXT
  IF A$="N" THEN GOTO NODRAW
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                       ":GOTO SET
  LINE(X-8,Y-8)-(X+8,Y+8),15,BF
  GOTO ERASEA
  END
PAINTA:
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:PAINT    "
  PSET(X,Y),0
  LET A$=INKEY$
  IF A$="6" THEN X=X+3
  IF A$="4" THEN X=X-3
  IF A$="8" THEN Y=Y-3
  IF A$="2" THEN Y=Y+3
  IF A$="9" THEN X=X+3:Y=Y-3
  IF A$="7" THEN X=X-3:Y=Y-3
  IF A$="1" THEN X=X-3:Y=Y+3
  IF A$="3" THEN X=X+3:Y=Y+3
  IF A$="E" THEN GOTO ERASEA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="T" THEN GOTO TEXT
  IF A$="L" THEN GOTO LIN
  IF A$="N" THEN GOTO NODRAW
  IF A$="P" THEN GOTO ASKA
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                       ":PAINT(X,Y),G,A:GOTO SET
  PSET(X,Y),15
  GOTO PAINTA
  END
ASKA:
  COLOR 6
  LOCATE 3,2
  INPUT"The color of paint:";G
  LOCATE 3,2
  PRINT"                        "
  IF G>15 THEN G=15:CR$="WHITE":GOTO PAINTA
  IF G=0 THEN CR$="BLACK"
  IF G=1 OR G=9 OR G=3 OR G=11 THEN CR$="BLUE"
  IF G=2 OR A=10 THEN CR$="GREEN"
  IF G=4 THEN CR$="RED"
  IF G=5 THEN CR$="PURPLE"
  IF G=13 OR G=12 THEN CR$="PINK"
  IF G=6 THEN CR$="ORANGE"
  IF G=7 OR G=8 THEN CR$="GREY"
  IF G=14 THEN CR$="YELLOW"
  IF G=15 THEN CR$="WHITE"
  LOCATE 2,53
  COLOR 14
  PRINT"         "
  LOCATE 2,53
  PRINT CR$
  GOTO PAINTA
  END
BRUSH:
  COLOR 14
  LOCATE 2,42
  PRINT"Line color:";CR$
  LOCATE 3,42
  PRINT"Coordinate X:";X
  LOCATE 3,60
  PRINT"Coordinate Y:";Y
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:BRUSH      "
  LOCATE 3,2
  COLOR 0
  PRINT"                        "
  LET A$=INKEY$
  IF POP=0 THEN GOTO SIZE
  IF A$="6" THEN X=X+1
  IF A$="4" THEN X=X-1
  IF A$="8" THEN Y=Y-1
  IF A$="2" THEN Y=Y+1
  IF A$="9" THEN X=X+1:Y=Y-1
  IF A$="7" THEN X=X-1:Y=Y-1
  IF A$="1" THEN X=X-1:Y=Y+1
  IF A$="3" THEN X=X+1:Y=Y+1
  IF A$="E" THEN POP=0:GOTO ERASEA
  IF A$="P" THEN POP=0:GOTO PAINTA
  IF A$="Q" THEN POP=0:GOTO BRUSHA
  IF A$="C" THEN POP=0:GOTO CIRC
  IF A$="S" THEN POP=0:GOTO CSC
  IF A$="M" THEN POP=0:GOTO MON
  IF A$="T" THEN POP=0:GOTO TEXT
  IF A$="H" THEN POP=0:GOTO HELP
  IF A$="L" THEN POP=0:GOTO LIN
  IF A$="N" THEN POP=0:GOTO NODRAW
  IF A$="5" THEN GOTO CLRIN
  IF A$="B" THEN GOTO SIZE
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                      ":POP=0:GOTO DRAWA
  CIRCLE(X,Y),D,A
  PAINT(X,Y),A,A
  GOTO BRUSH
  END
CLRIN:
  COLOR 6
  LOCATE 3,2
  INPUT"Enter color(0-15):";A
  IF A>15 THEN A=15:CR$="WHITE":GOTO BRUSH
  IF A=0 THEN CR$="BLACK"
  IF A=1 OR A=9 OR A=3 OR A=11 THEN CR$="BLUE"
  IF A=2 OR A=10 THEN CR$="GREEN"
  IF A=4 THEN CR$="RED"
  IF A=5 THEN CR$="PURPLE"
  IF A=13 OR A=12 THEN CR$="PINK"
  IF A=6 THEN CR$="ORANGE"
  IF A=7 OR A=8 THEN CR$="GREY"
  IF A=14 THEN CR$="YELLOW"
  IF A=15 THEN CR$="WHITE"
  LOCATE 2,42
  PRINT"                        "
  GOTO BRUSH
  END
SIZE:
  LOCATE 3,2
  COLOR 6
  INPUT"Size of a brush:",D
  IF D<0 THEN D=0
  LOCATE 3,2
  PRINT"                     "
  LET POP=1
  GOTO BRUSH
  END
BRUSHA:
  COLOR 14
  LOCATE 2,42
  PRINT"Line color:";CR$
  LOCATE 3,42
  PRINT"Coordinate X:";X
  LOCATE 3,60
  PRINT"Coordinate Y:";Y
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:CUBE BRUSH"
  LOCATE 3,2
  COLOR 0
  PRINT"                       "
  IF POPQ=0 THEN GOTO SIZEA
  LET A$=INKEY$
  IF A$="6" THEN X=X+1
  IF A$="4" THEN X=X-1
  IF A$="8" THEN Y=Y-1
  IF A$="2" THEN Y=Y+1
  IF A$="9" THEN X=X+1:Y=Y-1
  IF A$="7" THEN X=X-1:Y=Y-1
  IF A$="1" THEN X=X-1:Y=Y+1
  IF A$="3" THEN X=X+1:Y=Y+1
  IF A$="5" THEN GOTO CLRINA
  IF A$="E" THEN POPQ=0:GOTO ERASEA
  IF A$="P" THEN POPQ=0:GOTO PAINTA
  IF A$="B" THEN POPQ=0:GOTO BRUSH
  IF A$="C" THEN POPQ=0:GOTO CIRC
  IF A$="S" THEN POPQ=0:GOTO CSC
  IF A$="M" THEN POPQ=0:GOTO MON
  IF A$="H" THEN POPQ=0:GOTO HELP
  IF A$="T" THEN POPQ=0:GOTO TEXT
  IF A$="L" THEN POPQ=0:GOTO LIN
  IF A$="N" THEN POPQ=0:GOTO NODRAW
  IF A$="Q" THEN GOTO SIZEA
  IF A$=CHR$(27) THEN LOCATE 2,2:COLOR 0:PRINT"QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ":GOTO DRAWA
  LINE(X-D,Y-D)-(X+D,Y+D),A,BF
  GOTO BRUSHA
  END
CLRINA:
  COLOR 6
  LOCATE 3,2
  INPUT"Enter color(0-15):";A
  IF A>15 THEN A=15:CR$="WHITE":GOTO BRUSHA
  IF A=0 THEN CR$="BLACK"
  IF A=1 OR A=9 OR A=3 OR A=11 THEN CR$="BLUE"
  IF A=2 OR A=10 THEN CR$="GREEN"
  IF A=4 THEN CR$="RED"
  IF A=5 THEN CR$="PURPLE"
  IF A=13 OR A=12 THEN CR$="PINK"
  IF A=6 THEN CR$="ORANGE"
  IF A=7 OR A=8 THEN CR$="GREY"
  IF A=14 THEN CR$="YELLOW"
  IF A=15 THEN CR$="WHITE"
  LOCATE 2,42
  PRINT"                        "
  GOTO BRUSHA
  END
SIZEA:
  LOCATE 3,2
  COLOR 6
  INPUT"Size of a brush:",D
  LOCATE 3,2
  PRINT"                     "
  POPQ=1
  GOTO BRUSHA
  END
CIRC:
  LET J=0.75
  PSET(X,Y),POINT(X+1,Y)
CIRCL:
  COLOR 14
  LOCATE 2,42
  PRINT"Line color:";CR$
  LOCATE 3,42
  PRINT"Coordinate X:";X
  LOCATE 3,60
  PRINT"Coordinate Y:";Y
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:CIRCLE    "
  CIRCLE(X,Y),V,POINT(X,Y),,,J
  LET A$=INKEY$
  IF A$="6" THEN X=X+3
  IF A$="4" THEN X=X-3
  IF A$="8" THEN Y=Y-3
  IF A$="2" THEN Y=Y+3
  IF A$="9" THEN V=V+2
  IF A$="7" THEN J=J+0.025
  IF A$="1" THEN V=V-2
  IF A$="3" THEN J=J-0.025
  IF A$="C" THEN GOTO CLOR
  IF A$="E" THEN GOTO ERASEA
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="L" THEN GOTO LIN
  IF A$="T" THEN GOTO TEXT
  IF A$="N" THEN GOTO NODRAW
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                      ":CIRCLE(X,Y),V,A,,,J:GOTO DRAWA
  CIRCLE(X,Y),V,A,,,J
  GOTO CIRCL
  END
CLOR:
  COLOR 6
  LOCATE 3,2
  INPUT"Enter color(0-15):";A
  IF A>15 THEN A=15:CR$="WHITE":LOCATE 3,2:PRINT"                                    ":GOTO CIRCL
  IF A=0 THEN CR$="BLACK"
  IF A=1 OR A=9 OR A=3 OR A=11 THEN CR$="BLUE"
  IF A=2 OR A=10 THEN CR$="GREEN"
  IF A=4 THEN CR$="RED"
  IF A=5 THEN CR$="PURPLE"
  IF A=13 OR A=12 THEN CR$="PINK"
  IF A=6 THEN CR$="ORANGE"
  IF A=7 OR A=8 THEN CR$="GREY"
  IF A=14 THEN CR$="YELLOW"
  IF A=15 THEN CR$="WHITE"
  LOCATE 2,42
  PRINT"                        "
  LOCATE 3,2
  PRINT"                                    "
  GOTO CIRCL
  END
CSC:
  CLS
  GOTO SET
  END
MON:
  IF W=0 THEN SCREEN 12:W=1:GOTO SET
  IF W=1 THEN SCREEN 8:W=2:GOTO SET
  IF W=2 THEN SCREEN 11:W=3:GOTO SET
  IF W=3 THEN SCREEN 9:W=0:GOTO SET
  END
HELP:
  LINE(0,0)-(639,50),0,BF
  LINE(1,1)-(639,50),15,B
'BEGIN
  COLOR 4
  LOCATE 1,38
  PRINT"HELP"
  LINE(1,1)-(639,1),15
  COLOR 8
  LOCATE 2,2
  PRINT"5-COLOR  E-ERASE  P-PAINT  B-BRUSH  Q-BRUSH 2  C-CIRCLE  S-CLEAR SCREEN  L-LINE"
  LOCATE 3,2
  PRINT"M-RESOLUTION  T-TEXT PASTE.  IN SOME FNC. PRESS IT'S BUTTON AGAIN AND MODIFY IT"
  LINE(639,1)-(639,50),15
'RETURN
  DO
  LOOP WHILE INKEY$=""
  LINE(0,0)-(639,50),0,BF
  LINE(1,1)-(639,50),0,B
  GOTO SET
  END
LIN:
  LET N=X:M=Y
SEK:
  COLOR 14
  LOCATE 2,42
  PRINT"Line color:";CR$
  LOCATE 3,42
  PRINT"Coordinate X:";N
  LOCATE 3,60
  PRINT"Coordinate Y:";M
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:LINE    "
  LOCATE 3,2
  COLOR 0
  PRINT"                        "
  LINE(X,Y)-(N,M),0
  LET A$=INKEY$
  IF A$="6" THEN N=N+3
  IF A$="4" THEN N=N-3
  IF A$="8" THEN M=M-3
  IF A$="2" THEN M=M+3
  IF A$="9" THEN N=N+3:M=M-3
  IF A$="7" THEN N=N-3:M=M-3
  IF A$="1" THEN N=N-3:M=M+3
  IF A$="3" THEN N=N+3:M=M+3
  IF A$="E" THEN GOTO ERASEA
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="T" THEN GOTO TEXT
  IF A$="H" THEN GOTO HELP
  IF A$="N" THEN GOTO NODRAW
  IF A$="L" THEN GOTO CLRB
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                      ":LINE(X,Y)-(N,M),A:LET X=N:LET Y=M:GOTO DRAWA
  LINE(X,Y)-(N,M),A
  GOTO SEK
  END
CLRB:
  COLOR 6
  LOCATE 3,2
  INPUT"Enter color(0-15):";A
  IF A>15 THEN A=15:CR$="WHITE":GOTO SEK
  IF A=0 THEN CR$="BLACK"
  IF A=1 OR A=9 OR A=3 OR A=11 THEN CR$="BLUE"
  IF A=2 OR A=10 THEN CR$="GREEN"
  IF A=4 THEN CR$="RED"
  IF A=5 THEN CR$="PURPLE"
  IF A=13 OR A=12 THEN CR$="PINK"
  IF A=6 THEN CR$="ORANGE"
  IF A=7 OR A=8 THEN CR$="GREY"
  IF A=14 THEN CR$="YELLOW"
  IF A=15 THEN CR$="WHITE"
  LOCATE 2,42
  PRINT"                        "
  GOTO SEK
  END
NODRAW:
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:NODRAW       "
  PSET(X,Y),POINT(X,Y+1)
  LET A$=INKEY$
  IF A$="6" THEN X=X+3
  IF A$="4" THEN X=X-3
  IF A$="8" THEN Y=Y-3
  IF A$="2" THEN Y=Y+3
  IF A$="9" THEN X=X+3:Y=Y-3
  IF A$="7" THEN X=X-3:Y=Y-3
  IF A$="1" THEN X=X-3:Y=Y+3
  IF A$="3" THEN X=X+3:Y=Y+3
  IF A$="E" THEN GOTO ERASEA
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="T" THEN GOTO TEXT
  IF A$="L" THEN GOTO LIN
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                      ":GOTO DRAWA
  PSET(X,Y),15
  GOTO NODRAW
  END
TEXT:
  LET CLG=POINT(X,Y+1)
  PSET(X,Y),POINT(X,Y+1)
TRIM:
  COLOR 4
  LOCATE 2,2
  PRINT"Draw type:TEXT PASTE   "
  ON ERROR GOTO TEXTER
  LOCATE PS,PO
  ON ERROR GOTO TEXTER
  COLOR CLG
  PRINT"л"
  LET A$=INKEY$
  IF A$="6" THEN PO=PO+1
  IF A$="4" THEN PO=PO-1
  IF A$="8" THEN PS=PS-1
  IF A$="5" THEN GOTO CILOR
  IF A$="2" THEN PS=PS+1
  IF A$="9" THEN PS=PS-1:PO=PO+1
  IF A$="7" THEN PS=PS-1:PO=PO-1
  IF A$="1" THEN PO=PO-1:PS=PS+1
  IF A$="3" THEN PO=PO+1:PS=PS+1
  IF A$="E" THEN GOTO ERASEA
  IF A$="T" THEN GOTO PIST
  IF A$="P" THEN GOTO PAINTA
  IF A$="B" THEN GOTO BRUSH
  IF A$="Q" THEN GOTO BRUSHA
  IF A$="C" THEN GOTO CIRC
  IF A$="S" THEN GOTO CSC
  IF A$="M" THEN GOTO MON
  IF A$="H" THEN GOTO HELP
  IF A$="L" THEN GOTO LIN
  IF A$=CHR$(27) THEN LOCATE 2,2:PRINT"                      ":GOTO DRAWA
  IF PS>22 THEN PS=PS-1
  IF PS<5 THEN PS=PS+1
  IF PO>79 THEN PO=PO-1
  IF PO<2 THEN PO=PO+1
  LOCATE PS,PO
  COLOR KZ
  PRINT"л"
  GOTO TRIM
  END
CILOR:
  COLOR 6
  LOCATE 3,2
  INPUT"The color of text:";KZ
  LOCATE 3,2
  PRINT"                        "
  IF KZ>15 THEN KZ=15:GOTO TRIM
  GOTO TRIM
  END
PIST:
  LOCATE PS,PO
  COLOR KZ
  INPUT"",TEXTIC$
  LET PO=PO+LEN(TEXTIC$)
  GOTO DRAWA
  END
TEXTER:
  COLOR 10
  LOCATE 3,2
  PRINT"Text paste error!"
  DELAY 1
  LOCATE 3,2
  PRINT"                 "
  LET PS=23:LET PO=2
  RESUME TRIM
  END
BLANK:
  CLS
  RANDOMIZE TIMER
  HJK%=INT(RND * 2)
  IF HJK%=0 THEN GOTO STARTW
  IF HJK%=1 THEN GOTO STARTJ
STARTW:
   RANDOMIZE TIMER
   X%=INT(RND * 640)
   Y%=INT(RND * 360)
   Z%=INT(RND * 2)
   T%=INT(RND * 40)
   PSET(X%,Y%),Z%
   IF T%=5 THEN GOTO ADDA
   IF T%=39 THEN GOTO ADDB
   IF T%=30 THEN GOTO ADDC
   IF INKEY$=CHR$(27) THEN GOTO START
   GOTO STARTW
   END
ADDA:
   PSET(X%,Y%),0
   DRAW"C1 E5 G2 H3 F5"
   DELAY 1
   PSET(X%,Y%),0
   DRAW"C0 E5 G2 H3 F5"
   GOTO STARTW
   END
ADDB:
   FOR L=1 TO 400
   PSET(X%,Y%),0
   DRAW"C0 H5 L30 D10 R30 E5 L30 H5 F5 G5 R20 G10 U10 BU10 U10 F10"
   FOR MK=1 TO 300
   NEXT MK
   LET X%=X%+1
   PSET(X%,Y%),0
   DRAW"C4 H5 L30 D10 R30 E5 L30 H5 F5 G5 R20 G10 U10 BU10 U10 F10"
   FOR MK=1 TO 300
   NEXT MK
   NEXT L
   PSET(X%,Y%),0
   DRAW"C0 H5 L30 D10 R30 E5 L30 H5 F5 G5 R20 G10 U10 BU10 U10 F10"
   GOTO STARTW
   END
ADDC:
   FOR LOP=1 TO 15 STEP+0.05
   CIRCLE(X%,Y%),LOP,1
   NEXT LOP
   FOR JK=1 TO 500
   NEXT JK
   FOR LOP=1 TO 15 STEP+0.05
   CIRCLE(X%,Y%),LOP,0
   NEXT LOP
   GOTO STARTW
   END
STARTJ:
   RANDOMIZE TIMER
   DF%=INT(RND * 250)
   DN%=INT(RND * 250)
   X=DF%
   Y=DN%
   SCREEN 9
   LINE (7, 7)-(630, 7)
   LINE (630, 7)-(630, 335)
   LINE (630, 335)-(7, 335)
   LINE (7, 335)-(7, 7)
   LINE (7, 30)-(630, 30)
   LOCATE 2, 2
   COLOR 2
   PRINT " л                 лллллллллллллллллллллллллллллллллллллллллллллллллллллл"
   COLOR 3
   LOCATE 2, 4
   PRINT "Upgrade graphic editor"
   LINE (600, 7)-(600, 30)
   LINE (602, 28)-(628, 9)
   LINE (602, 9)-(628, 28)
BEGINSUBR:
   LINE (9,32)-(628,32)
   LINE (628,32)-(628,57)
   LINE (628,57)-(9,57)
   LINE (9,57)-(9,32)
   COLOR 14
   LOCATE 4,3
   PRINT"(N)ew                              (H)elp                             (Q)uit"
   DO
AG:
'ANIMATION
   RANDOMIZE TIMER
   TG%=INT(RND * 2)
   TH%=INT(RND * 2)
   ZX%=INT(RND * 4)
   AR%=INT(RND * 14)
   IF AR%=0 THEN GOTO AG
ANIM:
   FOR LN=1 TO 100
   CIRCLE(X,Y),3,AR%
   PAINT(X,Y),AR%,AR%
   IF X<0 THEN X=X+20:GOTO AG
   IF X>630 THEN X=X-20:GOTO AG
   IF Y>430 THEN Y=Y-40:GOTO AG
   IF Y<0 THEN Y=Y+30:GOTO AG
   IF ZX%=0 THEN X=X+TG%:Y=Y+TH%
   IF ZX%=1 THEN X=X-TG%:Y=Y-TH%
   IF ZX%=2 THEN X=X+TG%:Y=Y-TH%
   IF ZX%=3 THEN X=X-TG%:Y=Y+TH%
   FOR K=1 TO 3000
   NEXT K
   IF INKEY$=CHR$(27) THEN GOTO START
   NEXT LN
   LOOP
   END
ASKME:
  COLOR 10
  LOCATE 3,2
  INPUT"Do you want to quit ?(Y/N):",L$
  IF L$="Y" THEN GOTO BEASK
  LOCATE 3,2
  PRINT"                                  "
  GOTO DRAWA
  END
BEASK:
  COLOR 12
  LOCATE 3,2
  PRINT"                                  "
  LOCATE 3,2
  INPUT"Save the picture ?(Y/N):",LN$
  IF LN$="Y" THEN GOTO SAVA
  GOTO START
  END
SAVA:
  GET(3,51)-(211,348),PAR%
  GET(212,51)-(423,348),PBR%
  GET(424,51)-(638,348),PCR%
  CLS
DIRS:
   COLOR 3
   PRINT"Current DIR: ";DIR$
   COLOR 4
   ON ERROR GOTO NOF
   FILES"*.UGE"
   ON ERROR GOTO NOF
WOK:
    LINE(0,300)-(639,305),12,BF
    LINE(0,323)-(639,328),12,BF
    LINE(0,300)-(639,305),15,B
    LINE(0,323)-(639,328),15,B
   COLOR 14
   LOCATE 23,1
   INPUT"CHANGE CURRENT DIRECTORY ?(Y/N):",PO$
   IF PO$="Y" THEN GOTO CHN
POK:
   LOCATE 23,1
   COLOR 14
   INPUT"ENTER NAME OF THE FILE(WITHOUT AN EXTENSION):",NAM$
   GOTO WRIT
   END
CHN:
   LOCATE 23,1
   PRINT"                                                              "
   LOCATE 23,1
   COLOR 14
   INPUT"CHANGE DIRECTORY TO:",LOP$
   ON ERROR GOTO CHER
   CHDIR LOP$
   ON ERROR GOTO CHER
   DIR$=LOP$
   CLS
   GOTO DIRS
   END
NOF:
   COLOR 4
   PRINT"No .UGE files found in this directory!"
   RESUME WOK
   END
CHER:
   COLOR 4
   LOCATE 23,1
   PRINT"                                                    "
   LOCATE 23,1
   PRINT"No such directory!"
   DELAY 1.5
   CLS
   RESUME DIRS
   END
ETR:
   LOCATE 23,1
   PRINT"                                                           "
   RESUME POK
   END
WRIT:
   ON ERROR GOTO ETR
   OPEN NAM$+".UGE" FOR OUTPUT AS #1
   ON ERROR GOTO ETR
   CLOSE #1
   COLOR 10
   PRST=0
   LOCATE 23,1
   PRINT"Saving file, please wait! Done on";PRST;" %                    "
   OPEN NAM$+".UGE" FOR APPEND AS #1
   FOR NM=0 TO 20000
   PRINT #1,PAR%(NM)
   NEXT NM
   LOCATE 23,34
   PRST=30
   PRINT CINT(PRST)
   FOR NM=0 TO 20000
   PRINT #1,PBR%(NM)
   NEXT NM
   LOCATE 23,34
   PRST=60
   PRINT CINT(PRST)
   FOR NM=0 TO 20000
   PRINT #1,PCR%(NM)
   NEXT NM
   CLOSE #1
   LOCATE 23,35
   PRINT"100"
   DELAY 1
   CLS
   GOTO START
   END
LOADA:
   CLS
DIRSQ:
   COLOR 3
   PRINT"Current DIR: ";DIR$
   COLOR 4
   ON ERROR GOTO NOFQ
   FILES"*.UGE"
   ON ERROR GOTO NOFQ
WOKQ:
    LINE(0,300)-(639,305),12,BF
    LINE(0,323)-(639,328),12,BF
    LINE(0,300)-(639,305),15,B
    LINE(0,323)-(639,328),15,B
   COLOR 14
   LOCATE 23,1
   INPUT"CHANGE CURRENT DIRECTORY ?(Y/N):",PO$
   IF PO$="Y" THEN GOTO CHNQ
POKQ:
   LOCATE 23,1
   COLOR 14
   INPUT"WHAT FILE TO OPEN(WITHOUT AN EXTENSION):",NAM$
   GOTO LODQ
   END
CHNQ:
   LOCATE 23,1
   PRINT"                                                              "
   LOCATE 23,1
   COLOR 14
   INPUT"CHANGE DIRECTORY TO:",LOP$
   ON ERROR GOTO CHERQ
   CHDIR LOP$
   ON ERROR GOTO CHERQ
   DIR$=LOP$
   CLS
   GOTO DIRSQ
   END
NOFQ:
   COLOR 4
   PRINT"No .UGE files found in this directory!"
   RESUME WOKQ
   END
CHERQ:
   COLOR 4
   LOCATE 23,1
   PRINT"                                                    "
   LOCATE 23,1
   PRINT"No such directory!"
   DELAY 1.5
   CLS
   RESUME DIRSQ
   END
ETRQ:
   LOCATE 23,1
   PRINT"                                                           "
   RESUME POKQ
   END
ERU:
   LOCATE 23,1
   COLOR 4
   PRINT"No such file or file error!                              "
   DELAY 1
   RESUME START
   END
LODQ:
   COLOR 10
   PRST=0
   LOCATE 23,1
   PRINT"Loading file, please wait! Loaded on";PRST;" %                    "
   ON ERROR GOTO ERU
   OPEN NAM$+".UGE" FOR INPUT AS #1
   ON ERROR GOTO ERU
   FOR NM=0 TO 20000
   INPUT #1,PAR%(NM)
   ON ERROR GOTO ERU
   NEXT NM
   LOCATE 23,37
   PRST=30
   PRINT CINT(PRST)
   FOR NM=0 TO 20000
   ON ERROR GOTO ERU
   INPUT #1,PBR%(NM)
   ON ERROR GOTO ERU
   NEXT NM
   LOCATE 23,37
   PRST=60
   PRINT CINT(PRST)
   FOR NM=0 TO 20000
   INPUT #1,PCR%(NM)
   ON ERROR GOTO ERU
   NEXT NM
   CLOSE #1
   LOCATE 23,38
   PRINT"100" 
   DELAY 1
   CLS
   PUT(3,51),PAR%
   PUT(212,51),PBR%
   PUT(424,51),PCR%
   GOTO CLAM
   END












