   SCREEN 12
   OPEN"INFO.DAT" FOR INPUT AS #1
   INPUT #1,AE,WR,TY,UI
   CLOSE
   OPEN"NAME.DAT" FOR INPUT AS #2
   INPUT #2,DX$
   CLOSE #2
   TIMER ON
   DRAW"TA90"
   StartTime = TIMER
   LET Z=1
   LET CAR$="S4 H5 G5 F5 E5 H5 E3 L5 F3 G5 F5 F3 L5 E3 E5 H5 E3 L3 U5 R8 L8 D5 R3 G3 F5 G5 F3 L3 D5 R5 E2 R5 F2 G2 L5 H2"
   LET MON$="S4 E5 F5 G5 H5 L3 H3 D5 E2 R3 BR10 R3 E3 D5 H2 L3 H5 U3 H3 R5 G2 D3 BD10 D3 F3 L5 E3"
   LET WEP$="S5 BU13 BR6 R8 D2 L8 U2 R8 U5 F7 L8"
   LET KNG$="S4 E5 D10 H5 BR5 BU5 R10 D10 L10 F5 E5 E5 H5 H5 G5 F10 U10 G10"
   LET HEL=AE
SPAWN:
   BM=TY
   BMB=5
   Q=400
   W=200
   ENS=1000
   ENL=0
   ENP=0
   SGS=UI
   AM=WR
   P=330
   L=410
   O=10
   M=10
   AMMO=20
   MA=10
   OA=10
   HL=30
   SG=10
   ZZ=300
   E=150
ONS:
'ENEMY CANNON
   LET S=290
   LET J=205
   'FOR IL=1 TO 10
   'CIRCLE(S,J),IL,6
   'NEXT IL
   'LINE(S-15,J)-(S+15,J),11
   'LINE(S,J-15)-(S,J+15),11
POO:
    LINE(320,150)-(420,290),15
    LINE(420,290)-(220,290),15
    LINE(220,290)-(320,150),15
    PAINT(300,280),8,15
'SIN
    LINE(300,200)-(300,250),15
    LINE(300,250)-(320,280),15
    LINE(320,280)-(340,250),15
    LINE(340,250)-(340,200),15
    LINE(340,200)-(335,185),15
    LINE(335,185)-(305,185),15
    LINE(305,185)-(300,200),15
    CIRCLE(310,220),10,15,,,2
    CIRCLE(330,220),10,15,,,2
    LINE(320,230)-(325,240),15
    LINE(325,240)-(315,240),15
    LINE(315,240)-(320,230),15
    LINE(310,250)-(330,250),15
    LINE(313,250)-(318,255),15
    LINE(318,255)-(318,250),15
    LINE(328,250)-(323,255),15
    LINE(323,255)-(323,250),15
    CIRCLE(310,225),3,15
    CIRCLE(330,225),3,15
    PAINT(310,220),4,15
    PAINT(330,220),4,15
    PAINT(310,225),5,15
    PAINT(330,225),5,15
    PAINT(310,200),6,15
    PAINT(317,252),12,15
    PAINT(325,252),12,15
    PAINT(320,235),1,15
'SINEND
'HEALTH
   LINE(320,370)-(340,390),9,BF
   LINE(320,370)-(340,390),15,B
'SHELLS
   FOR GJ=1 TO 10
   CIRCLE(570,400),GJ,1
   NEXT GJ
'CELLS
     LINE(60,80)-(80,100),13,BF
     LINE(60,80)-(80,100),15,B
     LINE(60,80)-(80,100),15
'BOMBS
     LINE(550,80)-(560,110),3,BF
     LINE(550,80)-(560,110),5
     LINE(560,80)-(550,110),5
     LINE(555,80)-(555,110),5
'LAVA
   LINE(10,35)-(50,450),4,BF
   LINE(600,35)-(640,450),4,BF
   LINE(11,35)-(599,60),4,BF
   LINE(11,420)-(599,450),4,BF
'LAVA1
   FOR LI=10 TO 50 STEP+O
   FOR LP=35 TO 450 STEP+M+RND*3
   PSET(LI,LP),12
   O=O-1
   M=M-1
   IF M<2 THEN M=10
   IF O<2 THEN O=10
   NEXT:NEXT
'LAVA2
   FOR LI=600 TO 640 STEP+O
   FOR LP=35 TO 450 STEP+M+RND*3
   PSET(LI,LP),12
   O=O-1
   M=M-1
   IF M<2 THEN M=10
   IF O<2 THEN O=10
   NEXT:NEXT
'LAVA3
   FOR LI=11 TO 599 STEP+O
   FOR LP=35 TO 60 STEP+M+RND*3
   PSET(LI,LP),12
   O=O-1
   M=M-1
   IF M<2 THEN M=10
   IF O<2 THEN O=10
   NEXT:NEXT
'LAVA4
   FOR LI=11 TO 599 STEP+O
   FOR LP=420 TO 450 STEP+M+RND*3
   PSET(LI,LP),12
   O=O-1
   M=M-1
   IF M<2 THEN M=10
   IF O<2 THEN O=10
   NEXT:NEXT
'TELEPORT #1
   FOR STP=1 TO 5
   GHZ%=INT(RND * 15)
   GHJ%=INT(RND * 15)
   FBN%=INT(RND * 2)
   IF FBN%=1 THEN PSET(320+GHZ%+1,400+GHJ%+1),10
   IF FBN%=0 THEN CIRCLE(320+GHZ%+1,400+GHJ%+1),1,0
   NEXT
START:
   IF HEL < 1 THEN GOTO BOOM
   PSET(P,L),0
   DRAW"C0"
   DRAW CAR$
   IF ENL<1 THEN GOTO ASS
   PSET(Q,W),0
   DRAW"C0"
   DRAW MON$
   RANDOMIZE TIMER
   GH%=INT(RND * 4)
   IF GH%=3 THEN GOTO NIRV
ASS:
   IF ENP<1 THEN GOTO ASSA
   PSET(ZZ,E),0
   DRAW"C0"
   DRAW KNG$
   RANDOMIZE TIMER
   GHB%=INT(RND * 5)
   IF GHB%=2 THEN GOTO KNAT
ASSA:
   COLOR 15,0
   IF HEL<30 THEN COLOR 12,0
   LOCATE 1,65
   PRINT"HEALTH:";CINT(HEL);"%  "
   LOCATE 2,65
   COLOR 15
   TIMEPAST = TIMER - StartTime
   COLOR 15
   LOCATE 1,1
   PRINT"SHELLS:";AM
   LOCATE 1,19
   PRINT"CELLS:";SGS
   LOCATE 1,35
   PRINT"BOMBS:";BM
   COLOR 14
   LOCATE 1,51
   PRINT"Press F1"
   LET A$=INKEY$
   IF A$=CHR$(0)+"H" THEN DRAW"TA90":L=L-5:Z=1
   IF A$=CHR$(0)+"P" THEN DRAW"TA-90":L=L+5:Z=2
   IF A$=CHR$(0)+"M" THEN DRAW"TA0":P=P+5:Z=3
   IF A$=CHR$(0)+"K" THEN DRAW"TA180":P=P-5:Z=4
   IF A$=CHR$(27) THEN RUN"EQUAKE.EXE"
   IF A$="P" OR A$="p" THEN LOCATE 15,35:COLOR 15:PRINT"PAUSE":DO:LOOP WHILE INKEY$="":LOCATE 15,35:PRINT"     "
   IF A$=CHR$(0)+"R" THEN GOTO SHOT
   IF A$=CHR$(0)+"S" THEN GOTO BSHOT
   IF A$=CHR$(0)+"G" THEN GOTO CSHOT
   IF A$=CHR$(0)+"Q" THEN GOTO AXE
   IF A$=CHR$(0)+"O" THEN GOTO BOMB
   IF A$=CHR$(0)+";" THEN GOTO HELP
   IF A$=CHR$(0)+"I" THEN GOTO INFRM
   IF L < 2 THEN L=L+10:GOTO BOOM
   IF L > 460 THEN L=L-10:GOTO BOOM
   IF P > 640 THEN P=P-10:GOTO BOOM
   IF P < 2 THEN P=P+10:GOTO BOOM
   IF POINT(P+1,L)=4 THEN HEL=HEL-1:LOCATE 1,65:PRINT"                ":LOCATE 1,65:COLOR 5:PRINT"HEALTH:"CINT(HEL);"%":COLOR 15,4:LOCATE 1,75:COLOR 0:PRINT"PP":RANDOMIZE TIMER:CV%=INT(RND * 2):IF CV%=1 THEN SOUND 100,1
   IF POINT(P+1,L)=2 THEN HEL=HEL-0.4:LOCATE 1,65:PRINT"                   ":LOCATE 1,65:COLOR 10:PRINT"HEALTH:"CINT(HEL);"%":COLOR 15,2:LOCATE 1,77:COLOR 0:PRINT"PP":RANDOMIZE TIMER:CV%=INT(RND * 2):IF CV%=1 THEN SOUND 50,1
   IF POINT(P+1,L+1)=15 OR POINT(P+1,L)=8 AND Z=3 THEN P=P-6
   IF POINT(P+1,L+1)=15 OR POINT(P+1,L)=8 AND Z=1 THEN L=L+6
   IF POINT(P+1,L+1)=15 OR POINT(P+1,L)=8 AND Z=2 THEN L=L-6
   IF POINT(P+1,L+1)=15 OR POINT(P+1,L)=8 AND Z=4 THEN P=P+6
   IF POINT(P+1,L)=9 THEN HEL=HEL+HL:IF HL>0 THEN SOUND 1000,1:HL=0
   IF POINT(P+1,L)=13 THEN SGS=SGS+SG:IF SG>0 THEN SOUND 500,1:SG=0
   IF POINT(P+1,L)=1 THEN AM=AM+AMMO:IF AMMO>0 THEN SOUND 100,1:AMMO=0
   IF POINT(P+1,L)=3 THEN BM=BM+BMB:IF BMB>0 THEN SOUND 40,1:BMB=0
   IF POINT(Q-20,W)=8 THEN Q=Q+5
   IF POINT(Q+20,W)=8 THEN Q=Q-5
   IF POINT(Q,W+20)=8 THEN W=W-5
   IF POINT(Q,W-20)=8 THEN W=W+5
   IF POINT(Q+1,W)=4 THEN ENL=ENL-0.7
   IF POINT(Q+1,W)=2 THEN ENL=ENL-0.2
   IF POINT(ZZ-25,E)=8 THEN ZZ=ZZ+5
   IF POINT(ZZ+25,E)=8 THEN ZZ=ZZ-5
   IF POINT(ZZ,E+25)=8 THEN E=E-5
   IF POINT(ZZ,E-25)=8 THEN E=E+5
   IF POINT(ZZ+1,E)=2 THEN ENP=ENP-0.2
   IF ENS<1 THEN GOTO DEATH
   IF GHN>0 THEN GOTO CHK
   PSET(P,L)
   DRAW"C15"
   DRAW CAR$
   IF ENL<1 THEN PSET(Q,W):DRAW"C0":DRAW MON$:GOTO URG
   PSET(Q,W),0
   DRAW"C15"
   DRAW MON$
URG:
   IF ENP<1 THEN GOTO URGA
   PSET(ZZ,E),0
   DRAW"C15"
   DRAW KNG$
URGA:
   LET GHN=GHN+ZA
   IF ENS<1 THEN GOTO POO
   IF (S-P)<150 AND S>P AND (L-J)<150 THEN GOTO ENHT
   IF (P-S)<150 AND P>S AND (L-J)<150 THEN GOTO ENHT
   GOTO POO
   END
HELP:
    CLS
    ER=10
    EN=10
    LINE(1,1)-(639,479),15,B
    LINE(3,3)-(636,476),15,B
    PAINT(2,2),4,15
    LINE(10,10)-(629,469),15,B
    PAINT(5,5),2,15
    COLOR 8
    LOCATE 2,35
    PRINT"HELP PAGE #1"
    COLOR 7
    LINE(50,50)-(100,100),2,BF
    FOR JK=50 TO 100 STEP+ER-3
    FOR JA=50 TO 100 STEP+EN-3
    PSET(JK,JA),10
    ER=ER-1
    EN=EN-1
    IF ER=5 THEN ER=10
    IF EN=5 THEN EN=10
    NEXT
    NEXT
    LINE(50,110)-(100,160),4,BF
    FOR JK=50 TO 100 STEP+RND*4
    FOR TU=110 TO 160 STEP+RND*10
    PSET(JK,TU),12
    NEXT
    NEXT
'HEALTH
   LINE(65,210)-(85,230),9,BF
   LINE(65,210)-(85,230),15,B
'SHELLS
   FOR GJ=1 TO 10
   CIRCLE(75,180),GJ,1
   NEXT GJ
'CELLS
   LINE(65,240)-(85,260),13,BF
   LINE(65,240)-(85,260),15,B
   LINE(65,240)-(85,260),15
'BOMBS
   LINE(65,300)-(75,330),3,BF
   LINE(65,300)-(75,330),5
   LINE(70,300)-(70,330),5
   LINE(75,300)-(65,330),5
'AXE
   PSET(50,390),0
   DRAW"C15 TA0 BR0 BU0 BD0 BL0 S8 BU13 BR6 R8 D2 L8 U2 R8 U5 F7 L8"
'ABOUT SLIME
   COLOR 7
   LOCATE 4,15
   PRINT"This is slime. If you'll go in there it'll be not so good"
   LOCATE 5,15
   PRINT"If there is a monster, try to make him go in that slime"
   LOCATE 6,15
   PRINT"Then that guy will have some problems"
'ABOUT LAVA
   COLOR 14
   LOCATE 8,15
   PRINT"This is hot lava. It'll be even more painful than the slime"
   LOCATE 9,15
   PRINT"You can also make your enemy go in there and he'll fry"
'ABOUT BLASTER
   COLOR 6
   LOCATE 12,15
   PRINT"That's ammo for your blaster gun(Shoot-Ins). Shells amount: 20"
'ABOUT HEALTH
   COLOR 1
   LOCATE 14,15
   PRINT"This is a health powerup. You'll need it. Health amount: 30%"
'ABOUT SLUGS
   COLOR 4
   LOCATE 16,15
   PRINT"This is an energy cell pack. You'll need it to shoot with your"
   LOCATE 17,15
   PRINT"Thunderbolt or Twistgun(Shoot thunder-Home, shoot twist-Del)."
   LOCATE 18,15
   PRINT"Cells amount: 10"
'ABOUT BOMBS
   COLOR 3
   LOCATE 20,15
   PRINT"This is a bomb pack. You'll need it to throw your bombs."
   LOCATE 21,15
   PRINT"(Throw bombs-End). Bombs amount: 5"
'ABOUT AXE
   COLOR 2
   LOCATE 23,15
   PRINT"When you're out of ammo, you can use your axe(Hit with axe-PgDn)"
'PRESS A KEY
   DO
   LOOP WHILE INKEY$=""
   CLS
'NEW SUFF !!!!!!!!!
   LINE(1,1)-(639,479),15,B
   LINE(3,3)-(636,476),15,B
   PAINT(2,2),4,15
   LINE(10,10)-(629,469),15,B
   PAINT(5,5),2,15
   COLOR 8
   LOCATE 2,35
   PRINT"HELP PAGE #2"
   COLOR 7
   LOCATE 3,3
   PRINT"In each level you must find the exit and get there in time."
   LOCATE 4,3
   PRINT"But first you must beat all of the monsters"
   LOCATE 5,3
   PRINT"Some of them are just standing and when you aproach to them"
   LOCATE 6,3
   PRINT"close enough they shoot (Example: cannon)"
   LOCATE 7,3
   PRINT"Some of them are moveing (Example: monster-robot)"
   LOCATE 8,3
   PRINT"On your way it'll be lot's of stuff like teleports, lava and slime."
   LOCATE 9,3
   PRINT"Try to survive."
   COLOR 4
   LOCATE 23,3
   PRINT"Copyright in 2000y."
   DO
   LOOP WHILE INKEY$=""
   CLS
   GOTO ONS
   END
INFRM:
   CLS
   COLOR 8
   LOCATE 1,1
   PRINT"BOLTER'S HEALTH:";CINT(ENS);"%"
   'LOCATE 1,24
   'PRINT"Monster-robot's health:";CINT(ENL);"%"
   'LOCATE 1,54
   'PRINT"Slasher's health:";CINT(ENP);"%"
   COLOR 4
   LOCATE 2,1
   PRINT"Your time:";CINT(TIMEPAST);"seconds"
   LOCATE 3,1
   PRINT"Level's name: BOLTER'S DOOM"
   DO
   LOOP WHILE INKEY$=""
   CLS
   GOTO ONS
   END
BOOM:
   COLOR 15,0
   IF POINT(P+1,L)=4 THEN ZAR=1
   IF POINT(P+1,L)=2 THEN ZAR=2
   IF POINT(P,L)=14 THEN ZAR=3
   FOR F=1 TO 25
   CIRCLE(P,L),F,0
   NEXT
   FOR F=1 TO 25
   CIRCLE(P-10,L+10),F,0
   NEXT
   FOR F=1 TO 20
   CIRCLE(P-25,L-10),F,0
   NEXT
   BEEP
   BEEP
   LET HEL=AE
   DELAY 0.5
   LOCATE 2,35
   COLOR 8,0
   IF ZAR=1 THEN LOCATE 2,25:PRINT DX$;" thought lava was funny water":GOTO MAN
   IF ZAR=2 THEN LOCATE 2,32:PRINT DX$;" turned in green":GOTO MAN
   IF ZAR=3 THEN LOCATE 2,35:PRINT DX$;" rode the lightning":GOTO MAN
   PRINT DX$;" died!"
MAN:
   DELAY 1
   CLS
   ZAR=0
   LET SGS=UI
   GOTO SPAWN
   END
SHOT:
   IF AM=0 THEN GOTO POO
   SOUND 120,1
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   PSET(P,L),0
   DRAW"C4 BR13 BD13 R80"
   FOR N=1 TO 10000
   NEXT N
   AM=AM-1
   LET ZA=1
   GOTO POO
   END
BSHOT:
   IF SGS<5 THEN GOTO POO
   SOUND 200,2
   IF Z=1 THEN GOTO ARG
   IF Z=2 THEN GOTO ARH
   IF Z=3 THEN GOTO ARI
   IF Z=4 THEN GOTO ARM
   END
ARI:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   LET I=P
   LET LO=2
   FOR I=P TO P+180 STEP+10
   CIRCLE(I,L),LO,3
   LET LO=LO+1
   NEXT I
   DELAY 0.3
   SGS=SGS-5
   LET ZA=1
   GOTO POO
   END
ARM:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   LET I=P
   LET LO=2
   FOR I=P TO P-180 STEP-10
   CIRCLE(I,L),LO,3
   LET LO=LO+1
   NEXT I
   DELAY 0.3
   SGS=SGS-5
   LET ZA=1
   GOTO POO
   END
ARG:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   LET I=L
   LET LO=2
   FOR I=L TO L-180 STEP-10
   CIRCLE(P,I),LO,3
   LET LO=LO+1
   NEXT I
   DELAY 0.3
   SGS=SGS-5
   LET ZA=1
   GOTO POO
   END
ARH:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   LET I=L
   LET LO=2
   FOR I=L TO L+180 STEP+10
   CIRCLE(P,I),LO,3
   LET LO=LO+1
   NEXT I
   DELAY 0.3
   SGS=SGS-5
   LET ZA=1
   GOTO POO
   END
CSHOT:
   IF SGS<2 THEN GOTO POO
   SOUND 1000,1
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   PSET(P,L),0
   DRAW"C14 BR13 BD13 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30"
   PSET(P,L),0
   DRAW"C14 BR13 BD12 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30"
   PSET(P,L),0
   DRAW"C14 BR13 BD14 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30 H2 R30"
   FOR N=1 TO 50000
   NEXT N
   SGS=SGS-2
   LET ZA=1
   GOTO POO
   END
AXE:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   PSET(P,L),0
   DRAW"C15"
   DRAW WEP$
   FOR LKJ=1 TO 10000
   NEXT LKJ
   LET ZA=1
   LET AXE=1
   GOTO POO
   END
BOMB:
   NK=P
   NI=L
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   IF BM<1 THEN GOTO POO
   FOR UIY=1 TO 100
   PSET(NK,NI),0
   DRAW"C0 BR10 E3 F3 G3 H3"
   FOR N=1 TO 1000
   NEXT N
   IF Z=1 THEN NI=NI-1
   IF Z=2 THEN NI=NI+1
   IF Z=3 THEN NK=NK+1
   IF Z=4 THEN NK=NK-1
   PSET(NK,NI),0
   DRAW"C15 BR10 E3 F3 G3 H3"
   FOR N=1 TO 1000
   NEXT N
   NEXT UIY
   FOR F=1 TO 25
   CIRCLE(NK,NI),F,12
   NEXT
   FOR F=1 TO 25
   CIRCLE(NK-10,NI+10),F,12
   NEXT
   FOR F=1 TO 20
   CIRCLE(NK-25,NI-10),F,12
   NEXT
   ZA=1
   BM=BM-1
   GOTO POO
   END
ENHT:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   IF ENS<1 THEN LOCATE 1,35:COLOR 8:PRINT"CANNON DEFEATED":DELAY 1:GOTO POO
   FOR MN=J+30-10 TO J+30+10
   FOR M=S+30-10 TO S+30+10
   IF POINT(M,MN)=4 THEN ENS=ENS-20:GOTO CHK
   IF POINT(M,MN)=14 THEN ENS=ENS-50:GOTO CHK
   IF POINT(M,MN)=3 THEN ENS=ENS-100:GOTO CHK
   IF POINT(M,MN)=12 THEN ENS=ENS-80:GOTO CHK
   IF AXE=1 AND (S-P)<30 AND S>P AND Z=3 THEN ENS=ENS-10:GOTO CHK
   IF AXE=1 AND (P-S)<30 AND P>S AND Z=4 THEN ENS=ENS-10:GOTO CHK
   IF AXE=1 AND (L-J)<30 AND L>J AND Z=1 THEN ENS=ENS-10:GOTO CHK
   IF AXE=1 AND (J-L)<30 AND J>L AND Z=2 THEN ENS=ENS-10:GOTO CHK
   NEXT
   NEXT
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   RANDOMIZE TIMER
   DFG%=INT(RND * 10)
   IF DFG%=2 THEN GOTO ARTY
   GOTO POO
   END
ARTY:
   LINE(S+30,J+30)-(P,L),14
   LINE(S+31,J+31)-(P+1,L+1),14
   LINE(S+29,J+29)-(P-1,L-1),14
   HEL=HEL-5
   FOR N=1 TO 10000
   NEXT N
   SOUND 1000,1
   LINE(S+30,J+30)-(P,L),0
   LINE(S+31,J+31)-(P+1,L+1),0
   LINE(S+29,J+29)-(P-1,L-1),0
   GOTO POO
   END
CHK:
   CLS
   GOTO IRT
IRT:
   LET ZA=0
   LET GHN=0
   LET AXE=0
   GOTO ONS
   END
NIRV:
   PSET(P,L)
   DRAW"C15"
   DRAW CAR$
   IF ENL<1 THEN LOCATE 1,35:COLOR 8:PRINT"MONSTER DEFEATED":DELAY 1:GOTO POO
   IF Q>P THEN Q=Q-5
   IF Q<P THEN Q=Q+5
   IF W>L THEN W=W-5
   IF L>W THEN W=W+5
   PSET(Q,W)
   DRAW"C15"
   DRAW MON$
   IF (Q-P)<150 AND Q>P THEN GOTO ATTCK
   IF (P-Q)<150 AND P>Q THEN GOTO ATTCK
   IF (W-L)<150 AND W>L AND (Q-P)<150 AND Q>P THEN GOTO ATTCK
   IF (W-L)<150 AND W>L AND (P-Q)<150 AND Q<P THEN GOTO ATTCK
   IF (L-W)<150 AND L>W AND (Q-P)<150 AND Q>P THEN GOTO ATTCK
   IF (L-W)<150 AND L>W AND (P-Q)<150 AND Q<P THEN GOTO ATTCK
   IF L=W AND Q=P THEN GOTO ATTCK
   GOTO POO
   END
ATTCK:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   PSET(Q,W),0
   DRAW"C15"
   DRAW MON$
   IF ENL<1 THEN LOCATE 1,35:COLOR 8:PRINT"MONSTER DEFEATED":DELAY 1:GOTO POO
   HEL=HEL-3
   FOR MN=W-18 TO W+18
   FOR M=Q-18 TO Q+18
   IF POINT(M,MN)=4 THEN ENL=ENL-20:GOTO CHK
   IF POINT(M,MN)=14 THEN ENL=ENL-30:GOTO CHK
   IF POINT(M,MN)=3 THEN ENL=ENL-70:GOTO CHK
   IF POINT(M,MN)=12 THEN ENL=ENL-40:GOTO CHK
   IF AXE=1 AND (Q-P)<30 AND Q>P AND Z=3 THEN ENL=ENL-9:GOTO CHK
   IF AXE=1 AND (P-Q)<30 AND P>Q AND Z=4 THEN ENL=ENL-9:GOTO CHK
   IF AXE=1 AND (L-W)<30 AND L>W AND Z=1 THEN ENL=ENL-9:GOTO CHK
   IF AXE=1 AND (W-L)<30 AND W>L AND Z=2 THEN ENL=ENL-9:GOTO CHK
   IF AXE=1 AND W=L AND P=Q THEN ENL=ENL-9:GOTO CHK
   NEXT
   NEXT
   GOTO POO
   END
KNAT:
   PSET(P,L)
   DRAW"C15"
   DRAW CAR$
   IF ZZ>P THEN ZZ=ZZ-5
   IF ZZ<P THEN ZZ=ZZ+5
   IF E>L THEN E=E-5
   IF L>E THEN E=E+5
   PSET(ZZ,E)
   DRAW"C15"
   DRAW KNG$
   FOR MN=E-18 TO E+18
   FOR M=ZZ-18 TO ZZ+18
   IF POINT(M,MN)=4 THEN ENP=ENP-5:GOTO CHK
   IF POINT(M,MN)=14 THEN ENP=ENP-9:GOTO CHK
   IF POINT(M,MN)=3 THEN ENP=ENP-20:GOTO CHK
  'IF POINT(M,MN)=12 THEN ENP=ENP-5:GOTO CHK
   IF AXE=1 AND (ZZ-P)<30 AND ZZ>P AND Z=3 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (P-ZZ)<30 AND P>ZZ AND Z=4 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (L-E)<30 AND L>E AND Z=1 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (E-L)<30 AND E>L AND Z=2 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND E=L AND ZZ=P THEN ENP=ENP-8:GOTO CHK
   NEXT
   NEXT
   IF (ZZ-P)<30 AND (E-L)<30 AND ZZ>P AND E>L THEN GOTO KNA
   IF (ZZ-P)<30 AND (L-E)<30 AND ZZ>P AND L>E THEN GOTO KNA
   IF (P-ZZ)<30 AND (E-L)<30 AND P>ZZ AND E>L THEN GOTO KNA
   IF (P-ZZ)<30 AND (L-E)<30 AND P>ZZ AND L>E THEN GOTO KNA
   IF P=ZZ AND (L-E)<30 AND L>E THEN GOTO KNA
   IF P=ZZ AND (E-L)<30 AND E>L THEN GOTO KNA
   IF E=L AND (P-ZZ)<30 AND P>ZZ THEN GOTO KNA
   IF E=L AND (ZZ-P)<30 AND ZZ>P THEN GOTO KNA
   IF E=L AND P=ZZ THEN GOTO KNA
   GOTO POO
   END
KNA:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   PSET(ZZ,E),0
   DRAW"C15"
   DRAW KNG$
   IF ENP<1 THEN LOCATE 1,35:COLOR 8:PRINT"MONSTER DEFEATED":DELAY 1:GOTO POO
   HEL=HEL-3
   FOR MN=E-18 TO E+18
   FOR M=ZZ-18 TO ZZ+18
   IF POINT(M,MN)=4 THEN ENP=ENP-8:GOTO CHK
   IF POINT(M,MN)=14 THEN ENP=ENP-10:GOTO CHK
   IF POINT(M,MN)=3 THEN ENP=ENP-40:GOTO CHK
   IF POINT(M,MN)=12 THEN ENP=ENP-30:GOTO CHK
   IF AXE=1 AND (ZZ-P)<30 AND ZZ>P AND Z=3 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (P-ZZ)<30 AND P>ZZ AND Z=4 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (L-E)<30 AND L>E AND Z=1 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND (E-L)<30 AND E>L AND Z=2 THEN ENP=ENP-8:GOTO CHK
   IF AXE=1 AND E=L AND ZZ=P THEN ENP=ENP-8:GOTO CHK
   NEXT
   NEXT
   GOTO POO
   END
DEATH:
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
'BEGINEXPLOTION
   FOR MN=1 TO 300
DESTROY:
   V%=INT(RND * 200)
   B%=INT(RND * 250)
   H%=INT(RND * 50)
   IF B%<180 THEN GOTO DESTROY
   FOR K=1 TO H%
   CIRCLE(200+V%,10+B%),K,4
   NEXT K
   FOR JA=1 TO 700
   NEXT JA
   FOR K=1 TO H%
   CIRCLE(200+V%,10+B%),K,0
   PSET(P,L),0
   DRAW"C15"
   DRAW CAR$
   randomize timer
   TGH%=INT(RND * 3)
   IF TGH%=0 THEN SOUND 100,0.0005
   IF TGH%=1 THEN SOUND 300,0.0005
   IF TGH%=2 THEN SOUND 500,0.0005
   NEXT K
   NEXT MN
'ENDEXPLOTION
   DELAY 2.3
'EXITTHELEVEL
   LOCATE 16,30
   COLOR 14
   PRINT"YOU'VE EXITED THE LEVEL!"
   COLOR 4
   LOCATE 17,30
   PRINT"YOUR TIME:";CINT(TIMEPAST);"seconds"
   DO
   LOOP UNTIL INKEY$=CHR$(27)
   HEL=100
   AM=40
   BM=0
   SGS=0
   OPEN"INFO.DAT" FOR OUTPUT AS #1
   PRINT #1,HEL,AM,BM,SGS
   CLS
   RUN"LEVEL7.MAP"
   END


