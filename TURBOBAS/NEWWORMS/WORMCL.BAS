DIM PA%(25000)
DIM PB%(25000)
DIM PC%(25000)
STARTOFSTARTS:
CLS
COLOR 15, 3
LET DRILL$ = "R3 L6 G5 R16 H5 F5 L5 D10 L6 U10 D10 R3 D8 L10 R20"
LET MISS$ = "C15 U10 E3 F3 D10 L6 G5 D5 E5 R6 F5 U5 H5 BD3 P2,15 BL3 BU10 P6,15"
LET NOMISS$ = "C3 U10 E3 F3 D10 L6 G5 D5 E5 R6 F5 U5 H5 BD3 P3,3 BL3 BU10 P3,3"
LET PARA$ = "C15R5F10L25E10G10C1F13U12D12E12G12C15L5D5R10U5L5BD3P8,15BU20P2,15"
LET NOPARA$ = "C3R5F10L25E10G10C3F13U12D12E12G12C3L5D5R10U5L5BD3P3,3BU20P3,3"
LET RIP$ = "C15 U15 E5 R5 F5 D15 L15 BE8 P9,15 C1 BD3 U7 D3 R3 L6 BU3"
LET NORIP$ = "C3 U15 E5 R5 F5 D15 L15 BE8 P3,3 C3 BD3 U7 D3 R3 L6 BU3"
LET WEP$ = "BU3 C15 L8 U16 R16 D16 L8 R8 L3 H13 U3 R3 F13 U10 G13 L3 U3 E13 BU2 R5 D20 L20 U20 R15 BD1 P6,15 BD2 P2,15 BG10 P2,15 BU8 P2,15 BF8 P2,15 BH3 P10,15 BL5 P9,15 BR10 P9,15 BL5 BU5 P9,15 BD10 P9,15"
LET NOWEP$ = "BU3 C3 L8 U16 R16 D16 L8 R8 L3 H13 U3 R3 F13 U10 G13 L3 U3 E13 BU2 R5 D20 L20 U20 R15 BD1 P3,3 BD2 P3,3 BG10 P3,3 BU8 P3,3 BF8 P3,3 BH3 P3,3 BL5 P3,3 BR10 P3,3 BL5 BU5 P3,3 BD10 P3,3"
'STUFF
FALL = 0
FALLQ = 0
RANDOMIZE TIMER
'STUFF
'OPEN
  OPEN"WORMDATA.DAT" FOR INPUT AS #1
  INPUT #1,WORMAX$,WORMBX$,NOWORMAX$,NOWORMBX$,WORMAZ$,WORMBZ$,NOWORMAZ$,NOWORMBZ$
  CLOSE #1
  LET WORMA$=WORMAZ$
  LET WORMB$=WORMBZ$
  LET NOWORMA$=NOWORMAZ$
  LET NOWORMB$=NOWORMBZ$
  OPEN"NAMES.DAT" FOR INPUT AS #1
  INPUT #1,NAM$,NAMQ$
  CLOSE #1
  OPEN"INV.DAT" FOR INPUT AS #1
  INPUT #1,HEL,AIR,TEL,CLUS,MISS,GIRD,PARA,BLSCRN
  CLOSE #1
  HELQ=HEL
  AIRQ=AIR
  TELQ=TEL
  CLUSQ=CLUS
  MISSQ=MISS
  GIRDQ=GIRD
  PARAQ=PARA
  WEP=0
  DRIP=0
  DRIPQ=0
'OPEN
SCENE:
   SCREEN 9
LOADA:
   CLS
   DIR$="UNKNOWEN"
DIRSQ:
   COLOR 10
   PRINT"Current DIR: ";DIR$
   COLOR 4
   ON ERROR GOTO NOFQ
   FILES"*.MAP"
   ON ERROR GOTO NOFQ
WOKQ:
    LINE(0,300)-(639,305),12,BF
    LINE(0,323)-(639,328),12,BF
    LINE(0,300)-(639,305),15,B
    LINE(0,323)-(639,328),15,B
POKQ:
   LOCATE 23,1
   COLOR 14
   INPUT"WHAT FILE TO OPEN(WITHOUT AN EXTENSION):",NAMZ$
   GOTO LODQ
   END
NOFQ:
   COLOR 4
   PRINT"No .MAP files found !"
   RESUME WOKQ
   END
ERZ:
   LOCATE 23,1
   COLOR 4
   PRINT"File error!                                                  "
   DELAY 1.5
   END
LODQ:
   CLS
   SCREEN 12
   LOCATE 23,1
   COLOR 14
   PRINT"Wait! Opening file!                "
   ON ERROR GOTO ERZ
   OPEN NAMZ$+".MAP" FOR INPUT AS #1
   ON ERROR GOTO ERZ
   INPUT #1,X
   INPUT #1,Y
   INPUT #1,A
   INPUT #1,B
   FOR ION=0 TO 25000
   INPUT #1,PA%(ION)
   NEXT ION
   FOR ION=0 TO 25000
   INPUT #1,PB%(ION)
   NEXT ION
   FOR ION=0 TO 25000
   INPUT #1,PC%(ION)
   NEXT ION
   CLOSE #1
   ON ERROR GOTO ERZ
'DRAW IT
   PAINT(1,1),3,15
   PUT(0,35),PA%,PSET
   PUT(214,35),PB%,PSET
   PUT(428,35),PC%,PSET
   LINE(0,35)-(639,479),3,B
   GOTO STARTB
STARTA:
LINE (0, 470)-(640, 481), 3, BF
COLOR 15, 3
ZEN = 8
FOR UART = 1 TO 37
CIRCLE (ZEN, 460), 10, 15, 3.8, 5.8, 1
ZEN = ZEN + 18
NEXT UART
PAINT (10, 478), 5, 15
COLOR 15,3
DRUM:
IF FALL > 150 THEN HEL = HEL - 10: FALL = 0
IF FALLQ > 150 THEN HELQ = HELQ - 10: FALLQ = 0
COLOR 12
LOCATE 1, 57
PRINT NAM$; ":"; HEL
COLOR 7
LOCATE 2, 57
PRINT NAMQ$; ":"; HELQ
LINE (581, 0)-(640, 31), 3, BF
LINE (0, 32)-(640, 32), 15
LINE (440, 0)-(440, 32), 15
LINE (580, 0)-(580, 32), 15
LINE (0, 0)-(439, 31), 5, BF
LINE (40, 0)-(40, 32), 15
CIRCLE (20, 20), 10, 15
PAINT (20, 20), 2, 15
LINE (15, 5)-(25, 10), 7, BF
LINE (15, 5)-(25, 10), 15, B
LINE (80, 0)-(80, 32), 15
PSET (78, 15), 5
DRAW "C1 H5 L30 D10 R30 E5 L30 H5 F5 G5 R20 G10 U10 BU10 U10 F10"
LINE (120, 0)-(120, 32), 15
PSET (92, 16), 5
DRAW "C15 E15 D5 G12 E12 R5 G10 E10 U5 L5 F5 L5 E5 D5 G15 H5 L3 G5 F10 E5 H3 E2 BG5 P1,15 BU8 BR5 P2,15 BU5 P2,15"
LINE (160, 0)-(160, 32), 15
CIRCLE (140, 15), 15, 13
CIRCLE (140, 15), 13, 10, , , 2
CIRCLE (140, 15), 10, 10, , , .7
LINE (200, 0)-(200, 32), 15
CIRCLE (180, 15), 13, 15, , , 1.5
PAINT (180, 15), 13, 15
CIRCLE (180, 15), 10, 14, 2, 3, 1.5
LINE (240, 0)-(240, 32), 15
PSET (205, 13), 5
DRAW "C15 R15 D5 L15 U5 R15 E5 U5 R5 D25 L5 U5 H5 BR10 BD8 R3 U20 L3 BF1 P14,15 BL3 P12,15 BL10 BD7 P2,15"
LINE (280, 0)-(280, 32), 15
LINE (240, 15)-(260, 20), 15
LINE (260, 20)-(280, 5), 15
PAINT (250, 20), 8, 15
PSET (255, 0), 5
DRAW "C15 R10 F5 L20 E5 BD5 D8 R10 U8 D8 L3 D10 L4 U10 D10 R2 D5 F2 L4 E2 D1 BU8 P13,15 BU3 P13,15 C13 D4 L1 U4 R2 D4 BU10 P9,15 BU8 P2,15"
LINE (320, 0)-(320, 32), 15
PSET (295, 21), 5
DRAW "C15 U15 E5 F5 D15 L10 G5 D5 E5 R10 F5 U5 H5 U15 L10 BR5 BU2 P10,15 BD10 P6,15 BD10 P7,15"
LINE (360, 0)-(360, 32), 15
PSET (330, 25), 5
DRAW "C15U20R6D20L6BE2P1,15U1BR2D1BU15U1BL2D1 BR10 D10 R6 U10 L6 D10 R3 D10 BH1 U9 R2 D9 BU13 P2,15"
LINE (400, 0)-(400, 32), 15
CIRCLE (380, 12), 10, 15, -6, -9
PAINT (380, 10), 13, 15
LINE (370, 8)-(375, 25), 1
LINE (375, 25)-(380, 12), 1
LINE (390, 15)-(375, 25), 1
LINE (372, 25)-(378, 30), 8, BF
LINE (372, 25)-(378, 30), 15, B
LINE (440, 0)-(440, 32), 15
CIRCLE (420, 15), 13, 12
PSET (402, 6), 2
DRAW "C15 E5 F5 H2 L5"
'IFS
HULA:
IF HEL<1 AND HELQ<1 THEN GOTO DRAWGAM
IF HEL < 1 THEN GOTO RIPA
IF HELQ < 1 THEN GOTO RIPB
IF FALL > 150 THEN HEL = HEL - 10: FALL = 0: GOTO DRUM
IF FALLQ > 150 THEN HELQ = HELQ - 10: FALLQ = 0: GOTO DRUM
IF POINT(X + 10, Y + 22) = 3 THEN PSET (X, Y), 3: DRAW NOWORMA$: Y = Y + 1: FALL = FALL + 1: FOR N = 1 TO 500: NEXT: PSET (X, Y), 3: DRAW WORMA$: FOR N = 1 TO 500: NEXT: GOTO HULA
IF POINT(A + 10, B + 22) = 3 THEN PSET (A, B), 3: DRAW NOWORMB$: B = B + 1: FALLQ = FALLQ + 1: FOR N = 1 TO 500: NEXT: PSET (A, B), 3: DRAW WORMB$: FOR N = 1 TO 500: NEXT: GOTO HULA
FALL = 0
FALLQ = 0
IF Y>440 AND B>440 THEN GOTO DRAWGAM
IF X > 640 OR X < 0 OR Y > 440 OR Y < 0 THEN HEL = 0: PSET (X, Y), 3: DRAW NOWORMA$: GOTO WINA
IF A > 640 OR A < 0 OR B > 440 OR B < 0 THEN HELQ = 0: PSET (A, B), 3: DRAW NOWORMB$: GOTO WINB
'WEAPON DROP
IF WEP = 1 THEN GOTO CHES
IF PLA = 1 THEN GOTO CHES
RANDOMIZE TIMER
WEPA% = INT(RND * 5)
IF WEPA% = 2 THEN WEP = 1: GOTO DROP
CHES:
PLA = 1
'WEAPON CHECK
IF WEP = 0 THEN GOTO STRIK
FOR NLA = K% + 5 TO K% + 33
FOR NBA = W - 30 TO W + 5
IF POINT(NLA, NBA) = 4 THEN WEP = 0: GOTO RECV
IF POINT(NLA, NBA) = 1 THEN WEP = 0: GOTO RECB
IF POINT(K% + 20, W - 12) = 3 THEN WEP = 0: LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
NEXT
NEXT
'END WEAPON
STRIK:
LET A$ = INKEY$
IF A$ = CHR$(27) THEN GOSUB RUNNER
IF A$ = CHR$(0) + "M" THEN GOTO DIGR
IF A$ = CHR$(0) + "K" THEN GOTO DIGL
IF A$ = "1" THEN LOS$ = "USE BOMB(1P)": GOTO GREN
IF A$ = "2" THEN LOS$ = "USE AIR ATTACK(1P)": GOTO AIR
IF A$ = "3" THEN LOS$ = "USE CHAINGUN(1P)": GOTO CHAN
IF A$ = "4" THEN LOS$ = "USE TELEPORT(1P)": GOTO TELE
IF A$ = "5" THEN LOS$ = "USE HAND GRENADE(1P)": GOTO CLUSTER
IF A$ = "6" THEN LOS$ = "USE TAG(1P)": GOTO TAG
IF A$ = "7" THEN LOS$ = "USE PNEUMATIC DRILL(1P)": GOTO DRILL
IF A$ = "8" THEN LOS$ = "USE FIREBALL MISSILE(1P)": GOTO MISS
IF A$ = "9" THEN LOS$ = "USE BUILDER(1P)": GOTO BULD
IF A$ = "0" THEN LOS$ = "USE PARACHUTE BOMB(1P)": GOTO PARA
IF A$ = "A" OR A$ = "a" THEN LOS$ = "USEINV BLOWSCREEN(1,2P)": GOTO BLSCRN
IF A$ = "`" THEN GOTO CONSOLE
IF A$ = "D" AND DRIP=1 THEN WEP=1:LOS$="USEINV ITEMDROP":GOTO DROP
IF A$ = "d" AND DRIP=1 THEN WEP=1:LOS$="USEINV ITEMDROP":GOTO DROP
'KEYS
PSET (X, Y), 0
DRAW WORMA$
PSET (A, B), 0
DRAW WORMB$
GOTO HULA
END
DROP:
W = 90
K% = 0
K% = INT(RND * 600)
DO
PSET (K% + 20, W), 3
DRAW NOWEP$
W = W + 1
FOR N = 1 TO 300
NEXT N
PSET (K% + 20, W), 3
DRAW WEP$
FOR N = 1 TO 300
NEXT N
IF W > 450 THEN LINE (K% + 5, W - 25)-(K% + 33, W + 5), 3, BF: WEP = 0:GOTO DRUM
LOOP UNTIL POINT(K% + 20, W + 1) <> 3
GOTO DRUM
END
RECV:
RANDOMIZE TIMER
KIR% = INT(RND * 7)
IF KIR% = 0 THEN KRAT$ = "AIR STRIKE": AIR = AIR + 1
IF KIR% = 1 THEN KRAT$ = "TELEPORT": TEL = TEL + 1
IF KIR% = 2 THEN KRAT$ = "GRENADE": CLUS = CLUS + 1
IF KIR% = 3 THEN KRAT$ = "PARACHUTE BOMB": PARA = PARA + 1
IF KIR% = 4 THEN KRAT$ = "MULTI-MISSILE": MISS = MISS + 1
IF KIR% = 5 THEN KRAT$ = "METAL PLATES": GIRD = GIRD + 1
IF KIR% = 6 THEN KRAT$ = "+25% HEALTH": HEL = HEL + 25
LOCATE 4, 30
COLOR 15
PRINT "YOU GOT "; KRAT$
DELAY 1.5
LOCATE 4, 30
COLOR 3
PRINT "лллллллллллллллллллллллллллллллллллллллл"
LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
IF KIR% = 6 THEN GOTO DRUM
GOTO HULA
END
RECB:
RANDOMIZE TIMER
KIR% = INT(RND * 7)
IF KIR% = 0 THEN KRAT$ = "AIR STRIKE": AIRQ = AIRQ + 1
IF KIR% = 1 THEN KRAT$ = "TELEPORT": TELQ = TELQ + 1
IF KIR% = 2 THEN KRAT$ = "GRENADE": CLUSQ = CLUSQ + 1
IF KIR% = 3 THEN KRAT$ = "PARACHUTE BOMB": PARAQ = PARAQ + 1
IF KIR% = 4 THEN KRAT$ = "MULTI-MISSILE": MISSQ = MISSQ + 1
IF KIR% = 5 THEN KRAT$ = "METAL PLATES": GIRDQ = GIRDQ + 1
IF KIR% = 6 THEN KRAT$ = "+25% HEALTH": HELQ = HELQ + 25
LOCATE 4, 30
COLOR 15
PRINT "YOU GOT "; KRAT$
DELAY 1.5
LOCATE 4, 30
COLOR 3
PRINT "лллллллллллллллллллллллллллллллллллллллл"
LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
IF KIR% = 6 THEN GOTO DRUM
GOTO HULA
END
CONSOLE:
LINE (0, 0)-(640, 32), 16, BF
LINE (0, 32)-(640, 32), 15
COLOR 8, 0
LOCATE 1, 1
PRINT LOS$
COLOR 4
LOCATE 2, 1
INPUT "", LOS$
IF LOS$ = "Q" OR LOS$ = "q" THEN GOTO STARTA
IF LOS$ = "A" OR LOS$ = "a" THEN GOTO STARTA
IF LOS$ = "GIVE HEALTH(1P)" OR LOS$ = "give health(1p)" THEN HEL = HEL + 25
IF LOS$ = "GIVE FIVE(1P)" OR LOS$ = "give five(1p)" THEN CLUS = 5: AIR = 1: TEL = 2
IF LOS$ = "GIVE FM(1P)" OR LOS$ = "give fm(1p)" THEN MISS = 1
IF LOS$ = "GIVE BLOCK(1P)" OR LOS$ = "give block(1p)" THEN GIRD = 2
IF LOS$ = "GIVE PB(1P)" OR LOS$ = "give pb(1p)" THEN PARA = 1
IF LOS$ = "MOVE=0" OR LOS$ = "move=0" THEN GOTO QCONSOLE
IF LOS$ = "GM_RESTORE" OR LOS$ = "gm_restore" THEN GOTO SCENE
IF LOS$ = "GM_TOTAL" OR LOS$ = "gm_total" THEN GOTO STARTOFSTARTS
IF LOS$ = "GM_SDEATH" OR LOS$ = "gm_sdeath" THEN HEL = 1: HELQ = 1
IF LOS$ = "GM_SHOWRESOURCE" OR LOS$ = "gm_showresource" THEN LOCATE 2, 1: PRINT AIR; TEL; CLUS; MISS; GIRD; PARA; BLSCRN; "                ": DO: LOOP WHILE INKEY$ = ""
IF LOS$ = "GM_QUIT" OR LOS$ = "gm_quit" THEN END
IF LOS$ = "GM_GAMMA" OR LOS$ = "gm_gamma" THEN GOTO GAMMA
IF LOS$ = "GM_WORMGAMMA2" OR LOS$ = "gm_wormgamma2" THEN GOTO GAMMB
IF LOS$ = "GM_ITEMDROP" OR LOS$ = "gm_itemdrop" THEN WEP = 1: COLOR 15, 3: GOTO DROP
IF LOS$ = "GM_CURPOS" OR LOS$ = "gm_curpos" THEN LOCATE 2,1:PRINT"X:";X;" Y:";Y:DO:LOOP WHILE INKEY$=""
IF LOS$ = "GM_KILL" OR LOS$="gm_kill" THEN HEL=0:GOTO STARTA
IF LOS$ = "ON 'D' DROP" OR LOS$="on 'd' drop" THEN DRIP=1
GOTO CONSOLE
END
GAMMA:
PALETTE 1, 9
PALETTE 2, 3
PALETTE 3, 0
PALETTE 4, 6
PALETTE 5, 11
PALETTE 6, 14
PALETTE 7, 5
PALETTE 8, 2
PALETTE 9, 10
PALETTE 10, 12
PALETTE 11, 13
PALETTE 12, 1
PALETTE 13, 4
PALETTE 14, 7
PALETTE 15, 8
GOTO CONSOLE
END
GAMMB:
PALETTE 1, 4
PALETTE 2, 3
PALETTE 3, 9
PALETTE 4, 1
PALETTE 5, 8
PALETTE 6, 7
PALETTE 7, 14
PALETTE 8, -67
PALETTE 9, 10
PALETTE 10, 13
PALETTE 11, 12
PALETTE 12, 15
PALETTE 13, 16
PALETTE 14, 6
PALETTE 15, 11
GOTO CONSOLE
END
DIGR:
IF POINT(X + 15, Y - 5) <> 3 THEN GOTO HULA
PSET (X, Y), 0
DRAW NOWORMA$
FOR N = 1 TO 500
NEXT N
Y = Y - 1
X = X + 1
LET WORMA$=WORMAX$
LET NOWORMA$=NOWORMAX$
PSET (X, Y), 0
DRAW WORMA$
FOR N = 1 TO 500
NEXT N
GOTO HULA
END
DIGL:
IF POINT(X - 5, Y) <> 3 THEN GOTO HULA
PSET (X, Y), 0
DRAW NOWORMA$
FOR N = 1 TO 500
NEXT N
X = X - 1
Y = Y - 1
LET WORMA$=WORMAZ$
LET NOWORMA$=NOWORMAZ$
PSET (X, Y), 0
DRAW WORMA$
FOR N = 1 TO 500
NEXT N
GOTO HULA
END
GREN:
LET A$ = INKEY$
LOCATE 4, 1
COLOR 15
PRINT "Direction(<- or ->)"
IF A$ = CHR$(0) + "M" THEN GOTO THR
IF A$ = CHR$(0) + "K" THEN GOTO THL
IF A$ = CHR$(27) THEN GOTO ARTAQ
GOTO GREN
END
THR:
RG = X
RZ = Y
DO
CIRCLE (RG + 17, RZ), 4, 3
PAINT (RG + 17, RZ), 3, 3
RG = RG + 1
RZ=RZ+0.25
FOR N = 1 TO 200
NEXT N
CIRCLE (RG + 17, RZ), 4, 15
PAINT (RG + 17, RZ), 2, 15
FOR N = 1 TO 200
NEXT N
IF POINT(RG + 23, RZ) <> 3 THEN GOTO EXPL
IF POINT(RG + 23, RZ) = 1 THEN GOTO EXPL
LOOP UNTIL RG > 670
ARTA:
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTB
END
EXPL:
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 12
NEXT
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 3
NEXT
GOTO ARTA
END
THL:
RG = X
RZ = Y
DO
CIRCLE (RG - 17, RZ), 4, 3
PAINT (RG - 17, RZ), 3, 3
RG = RG - 1
RZ=RZ+0.25
FOR N = 1 TO 200
NEXT N
CIRCLE (RG - 17, RZ), 4, 15
PAINT (RG - 17, RZ), 2, 15
FOR N = 1 TO 200
NEXT N
IF POINT(RG - 23, RZ) <> 3 THEN GOTO EXPLA
IF POINT(RG - 23, RZ) = 1 THEN GOTO EXPLA
LOOP UNTIL RG < -70
ARTAA:
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTB
END
EXPLA:
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 12
NEXT
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 3
NEXT
GOTO ARTAA
END
AIR:
COLOR 15
LOCATE 1, 75
PRINT "AMMO"
LOCATE 2, 76
PRINT AIR
DELAY .5
IF AIR = 0 THEN GOTO STARTA
AR = 100
AG = 100
LOCATE 4, 1
COLOR 15
PRINT "Press SPACE when ready"
DO
LINE (AR, AG)-(AR + 10, AG), POINT(AR + 1, AG - 1)
LINE (AR + 5, AG - 5)-(AR + 5, AG + 5), POINT(AR + 1, AG - 1)
FOR N = 1 TO 500
NEXT N
LET A$ = INKEY$
IF A$ = CHR$(0) + "M" THEN AR = AR + 5
IF A$ = CHR$(0) + "K" THEN AR = AR - 5
IF A$ = CHR$(0) + "H" THEN AG = AG - 5
IF A$ = CHR$(0) + "P" THEN AG = AG + 5
IF A$ = CHR$(27) THEN GOTO ARTAQ
LINE (AR, AG)-(AR + 10, AG), 15
LINE (AR + 5, AG - 5)-(AR + 5, AG + 5), 15
FOR N = 1 TO 500
NEXT N
LOOP UNTIL A$ = " "
FOR NA = 1 TO 4
FOR N = 1 TO 30 STEP .05
CIRCLE (AR - 60, AG), N, 12
NEXT N
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 25
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 25
FOR N = 1 TO 30 STEP .05
CIRCLE (AR - 60, AG), N, 3
NEXT N
AR = AR + 60
AG = AG + 10
NEXT NA
LET AIR = AIR - 1
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTB
CHAN:
LET A$ = INKEY$
LOCATE 4, 1
COLOR 15
PRINT "Direction(< or > or ^)"
IF A$ = CHR$(0) + "M" THEN LO = 5: GOTO THRT
IF A$ = CHR$(0) + "K" THEN LO = 5: GOTO THLT
IF A$ = CHR$(0) + "H" THEN LO = 5: GOTO THUT
IF A$ = CHR$(27) THEN GOTO ARTAQ
GOTO CHAN
END
THRT:
IF LO = 0 THEN GOTO ARTAA
FOR AF = 1 TO 5
RG = X + 10
RZ = Y
DO
RG = RG + 1
IF POINT(RG + 15, RZ) = 1 THEN GOTO EXPLT
IF POINT(RG + 15, RZ) <> 3 THEN NOR = 1: GOTO EXPLT
LOOP UNTIL RG > 670
LO = LO - 1
NEXT AF
EXPLT:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X + 5, Y) = 15 THEN HEL = HEL - 3
IF POINT(A - 5, B) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTR
PSET (A, B), 3
DRAW NOWORMB$
A = A + 8
PSET (A, B), 3
DRAW WORMB$
ASTR:
LO = LO - 1
NOR = 0
GOTO THRT
END
THLT:
IF LO = 0 THEN GOTO ARTAA
FOR AF = 1 TO 5
RG = X - 10
RZ = Y
DO
RG = RG - 1
IF POINT(RG - 15, RZ) = 1 THEN GOTO EXPLTA
IF POINT(RG - 15, RZ) <> 3 THEN NOR = 1: GOTO EXPLTA
LOOP UNTIL RG > 670
LO = LO - 1
NEXT AF
EXPLTA:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X - 15, Y) = 15 THEN HEL = HEL - 3
IF POINT(A + 15, B) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTRA
PSET (A, B), 3
DRAW NOWORMB$
A = A - 8
PSET (A, B), 3
DRAW WORMB$
ASTRA:
LO = LO - 1
NOR = 0
GOTO THLT
END
THUT:
IF LO = 0 THEN GOTO ARTAA
FOR AF = 1 TO 5
RG = X
RZ = Y - 10
DO
RZ = RZ - 1
IF POINT(RG, RZ - 8) = 1 THEN GOTO EXPLTAU
IF POINT(RG, RZ - 8) <> 3 THEN NOR = 1: GOTO EXPLTAU
LOOP UNTIL RZ < 0
LO = LO - 1
NEXT AF
EXPLTAU:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X - 2, Y + 8) = 15 THEN HEL = HEL - 3
IF POINT(A - 2, B + 8) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTRAU
PSET (A, B), 3
DRAW NOWORMB$
B = B - 8
PSET (A, B), 3
DRAW WORMB$
ASTRAU:
LO = LO - 1
NOR = 0
GOTO THUT
END
TELE:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT TEL
    DELAY .5
    IF TEL = 0 THEN GOTO STARTA
    AR = 100
    AG = 100
    LOCATE 4, 1
    COLOR 15
    PRINT "Press SPACE when done"
    DO
    CIRCLE (AR, AG), 3, POINT(AR - 4, AG)
    FOR N = 1 TO 500
    NEXT N
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "M" THEN AR = AR + 9
    IF A$ = CHR$(0) + "K" THEN AR = AR - 9
    IF A$ = CHR$(0) + "H" THEN AG = AG - 9
    IF A$ = CHR$(0) + "P" THEN AG = AG + 9
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    CIRCLE (AR, AG), 3, 15
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL A$ = " "
'TELEPORT
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NO = 1 TO 8
    FOR N = 1 TO 15 STEP .01
    CIRCLE (X + 8, Y + 5), N, 10
    NEXT
    FOR N = 1 TO 15 STEP .01
    CIRCLE (X + 8, Y + 5), N, 3
    NEXT
    NEXT NO
    LET X = AR
    LET Y = AG
    FOR NO = 1 TO 8
    FOR N = 1 TO 15 STEP .01
    CIRCLE (X + 8, Y + 5), N, 10
    NEXT
    FOR N = 1 TO 15 STEP .01
    CIRCLE (X + 8, Y + 5), N, 3
    NEXT
    NEXT NO
    LET TEL = TEL - 1
    GOTO ARTAA
    END
CLUSTER:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT CLUS
    DELAY .5
    IF CLUS = 0 THEN GOTO STARTA
    LET A$ = INKEY$
    LOCATE 4, 1
    COLOR 15
    PRINT "Direction(<- or ->)"
    IF A$ = CHR$(0) + "M" THEN GOTO THRZ
    IF A$ = CHR$(0) + "K" THEN GOTO THLZ
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    GOTO CLUSTER
    END
THRZ:
    COLOR 3
    LOCATE 4, 1
    PRINT "лллллллллллллллллллллллл"
SEKT:
    IF NUM < 1 THEN NUM = 1
    IF NUM > 200 THEN NUM = 200
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "H" THEN NUM = NUM + 2
    IF A$ = CHR$(0) + "P" THEN NUM = NUM - 2
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    IF A$ = " " THEN GOTO LANC
    LOCATE 4, 1
    COLOR 15
    PRINT "Power( or )"; NUM
    GOTO SEKT
    END
LANC:
    RG = X
    RZ = Y
    FOR NR = 1 TO NUM
    CIRCLE (RG + 17, RZ), 7, 3, , , 1.5
    PAINT (RG + 17, RZ), 3, 3
    CIRCLE (RG + 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG + 1
    RZ = RZ - 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG + 17, RZ), 7, 15, , , 1.5
    PAINT (RG + 17, RZ), 12, 15
    CIRCLE (RG + 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    IF POINT(RG + 23, RZ) <> 3 THEN GOTO EXPLZ
    NEXT NR
    GOTO DOWNA
EXPLZ:
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUS = CLUS - 1
    GOTO STARTB
    END
DOWNA:
    DO
    CIRCLE (RG + 17, RZ), 7, 3, , , 1.5
    PAINT (RG + 17, RZ), 3, 3
    CIRCLE (RG + 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG + 1
    RZ = RZ + 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG + 17, RZ), 7, 15, , , 1.5
    PAINT (RG + 17, RZ), 12, 15
    CIRCLE (RG + 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(RG + 23, RZ) <> 3
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUS = CLUS - 1
    GOTO STARTB
    END
THLZ:
    COLOR 3
    LOCATE 4, 1
    PRINT "лллллллллллллллллллллллл"
SEKTZ:
    IF NUM < 1 THEN NUM = 1
    IF NUM > 200 THEN NUM = 200
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "H" THEN NUM = NUM + 2
    IF A$ = CHR$(0) + "P" THEN NUM = NUM - 2
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    IF A$ = " " THEN GOTO LANCZ
    LOCATE 4, 1
    COLOR 15
    PRINT "Power( or )"; NUM
    GOTO SEKTZ
    END
LANCZ:
    RG = X
    RZ = Y
    FOR NR = 1 TO NUM
    CIRCLE (RG - 17, RZ), 7, 3, , , 1.5
    PAINT (RG - 17, RZ), 3, 3
    CIRCLE (RG - 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG - 1
    RZ = RZ - 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG - 17, RZ), 7, 15, , , 1.5
    PAINT (RG - 17, RZ), 12, 15
    CIRCLE (RG - 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    IF POINT(RG - 23, RZ) <> 3 THEN GOTO EXPLZZ
    NEXT NR
    GOTO DOWNAZ
EXPLZZ:
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X - 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A + 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUS = CLUS - 1
    GOTO STARTB
    END
DOWNAZ:
    DO
    CIRCLE (RG - 17, RZ), 7, 3, , , 1.5
    PAINT (RG - 17, RZ), 3, 3
    CIRCLE (RG - 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG - 1
    RZ = RZ + 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG - 17, RZ), 7, 15, , , 1.5
    PAINT (RG - 17, RZ), 12, 15
    CIRCLE (RG - 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(RG - 23, RZ) <> 3
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X - 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A + 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUS = CLUS - 1
    GOTO STARTB
    END
TAG:
    LET A$ = INKEY$
    LOCATE 4, 1
    COLOR 15
    PRINT "Direction(<- or ->)"
    IF A$ = CHR$(0) + "M" THEN GOTO TAGR
    IF A$ = CHR$(0) + "K" THEN GOTO TAGL
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    GOTO TAG
    END
TAGR:
    FOR NRS = X - 13 TO X + 25
    FOR NMS = Y - 18 TO Y + 25
    IF POINT(NRS, NMS) = 1 THEN GOTO TAGIT
    NEXT
    NEXT
'DAMN IT
    FOR STAS = 1 TO 30
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    Y = Y - 1
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
'DAMN IT
TAGIT:
    FOR STAS = 1 TO 30
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    Y = Y - 1
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
'WORMDAMAGE
    FOR STAS = 1 TO 90
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    A = A + 1
    B = B - .5
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LET HELQ = HELQ - 10
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
TAGL:
    FOR NRS = X - 13 TO X + 25
    FOR NMS = Y - 18 TO Y + 25
    IF POINT(NRS, NMS) = 1 THEN GOTO TAGITZ
    NEXT
    NEXT
'DAMN IT
    FOR STAS = 1 TO 30
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    Y = Y - 1
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
'DAMN IT
TAGITZ:
    FOR STAS = 1 TO 30
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    Y = Y - 1
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
'WORMDAMAGE
    FOR STAS = 1 TO 90
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    A = A - 1
    B = B - .5
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LET HELQ = HELQ - 10
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
DRILL:
    LET A$ = INKEY$
    LOCATE 4, 1
    COLOR 15
    PRINT "Direction(< or > or )"
    IF A$ = CHR$(0) + "M" THEN GOTO RGH
    IF A$ = CHR$(0) + "K" THEN GOTO LFT
    IF A$ = CHR$(0) + "P" THEN GOTO DUP
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    GOTO DRILL
    END
RGH:
    RF = X
    RM = Y
    FOR N = 1 TO 170
    PSET (RF + 12, RM), 3
    DRAW "C3 TA90"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW NOWORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    RF = RF + 1
    X = X + 1
    PSET (RF + 12, RM), 3
    DRAW "C15 TA90"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW WORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    LET A$ = INKEY$
    IF A$ = " " THEN GOTO STP
    NEXT N
STP:
    PSET (RF + 12, RM), 3
    DRAW "C3 TA90"
    DRAW DRILL$
    DRAW "TA0"
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
LFT:
    RF = X
    RM = Y
    FOR N = 1 TO 170
    PSET (RF - 7, RM), 3
    DRAW "C3 TA270"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW NOWORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    RF = RF - 1
    X = X - 1
    PSET (RF - 7, RM), 3
    DRAW "C15 TA270"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW WORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    LET A$ = INKEY$
    IF A$ = " " THEN GOTO STPZ
    NEXT N
STPZ:
    PSET (RF - 7, RM), 3
    DRAW "C3 TA270"
    DRAW DRILL$
    DRAW "TA0"
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
DUP:
    RF = X
    RM = Y
    FOR N = 1 TO 170
    PSET (RF, RM + 12), 3
    DRAW "C3"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW NOWORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    RM = RM + 1
    Y = Y + 1
    PSET (RF, RM + 12), 3
    DRAW "C15"
    DRAW DRILL$
    PSET (X, Y), 3
    DRAW "TA0"
    DRAW WORMA$
    FOR NA = 1 TO 1000
    NEXT NA
    LET A$ = INKEY$
    IF A$ = " " THEN GOTO STPX
    NEXT N
STPX:
    PSET (RF, RM + 12), 3
    DRAW "C3"
    DRAW DRILL$
    DRAW "TA0"
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
MISS:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT MISS
    DELAY .5
    IF MISS = 0 THEN GOTO STARTA
    DO
    IF POW < 1 THEN POW = 1
    IF POW > 200 THEN POW = 200
    LOCATE 4, 1
    COLOR 15
    PRINT "Power( or ):"; POW
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "H" THEN POW = POW + 2
    IF A$ = CHR$(0) + "P" THEN POW = POW - 2
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    LOOP UNTIL A$ = " "
    QW = X
    WR = Y
'ATTACK
    FOR POK = 1 TO POW
    PSET (QW, WR - 15), 3
    DRAW NOMISS$
    FOR NM = 1 TO 250
    NEXT NM
    WR = WR - 1.5
    PSET (QW, WR - 15), 3
    DRAW MISS$
    FOR NM = 1 TO 250
    NEXT NM
    IF POINT(QW + 5, WR - 30) <> 3 THEN GOTO BOOM
    NEXT POK
BOOM:
    PSET (QW, WR - 15), 3
    DRAW NOMISS$
'CABOOM
    ZO = QW
    DF = WR
    DO
    FOR N = 1 TO 35 STEP .05
    CIRCLE (QW - 15, WR), N, 12
    NEXT N
    FOR N = 1 TO 35 STEP .05
    CIRCLE (ZO + 15, DF), N, 12
    NEXT N
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 23
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 23
    FOR N = 1 TO 35 STEP .05
    CIRCLE (QW - 15, WR), N, 3
    NEXT N
    FOR N = 1 TO 35 STEP .05
    CIRCLE (ZO + 15, DF), N, 3
    NEXT N
    QW = QW - 60
    ZO = ZO + 60
    LOOP UNTIL ZO > 640 AND QW < 0
'FINISH ATTACK
    MISS = MISS - 1
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллл"
    GOTO STARTB
    END
BULD:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT GIRD
    DELAY .5
    IF GIRD = 0 THEN GOTO STARTA
    AR = 100
    AG = 100
    LOCATE 4, 1
    COLOR 15
    PRINT "Press SPACE when done"
    DO
    CIRCLE (AR, AG), 2, POINT(AR + 3, AG)
    FOR N = 1 TO 500
    NEXT N
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "M" THEN AR = AR + 9
    IF A$ = CHR$(0) + "K" THEN AR = AR - 9
    IF A$ = CHR$(0) + "H" THEN AG = AG - 9
    IF A$ = CHR$(0) + "P" THEN AG = AG + 9
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    CIRCLE (AR, AG), 2, 15
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL A$ = " "
'START BUILDING
    CIRCLE (AR, AG), 2, 3
    LINE (AR, AG)-(AR + 20, AG + 100), 9, BF
    LINE (AR, AG)-(AR + 20, AG + 100), 15, B
    FOR TG = 1 TO 1
    CIRCLE (AR + 5, AG + 5), TG, 8
    PSET (AR + 5, AG + 5), 8
    CIRCLE (AR + 15, AG + 5), TG, 8
    PSET (AR + 15, AG + 5), 8
    CIRCLE (AR + 5, AG + 95), TG, 8
    PSET (AR + 5, AG + 95), 8
    CIRCLE (AR + 15, AG + 95), TG, 8
    PSET (AR + 15, AG + 95), 8
    NEXT TG
    GIRD = GIRD - 1
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
PARA:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT PARA
    DELAY .5
    IF PARA = 0 THEN GOTO STARTA
    LET A$ = INKEY$
    LOCATE 4, 1
    COLOR 15
    PRINT "Direction(<- or ->)"
    IF A$ = CHR$(0) + "M" THEN GOTO PARAR
    IF A$ = CHR$(0) + "K" THEN GOTO PARAL
    IF A$ = CHR$(27) THEN GOTO ARTAQ
    GOTO PARA
    END
PARAR:
    LET HJ = X
    LET CE = Y
    DO
    PSET (HJ + 25, CE), 3
    DRAW NOPARA$
    FOR N = 1 TO 500
    NEXT N
    CE = CE + 1
    PSET (HJ + 25, CE), 3
    DRAW PARA$
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(HJ + 25, CE + 35) <> 3
'EXPLODE
    PSET (HJ + 25, CE), 3
    DRAW NOPARA$
    FOR NAR = 1 TO 50 STEP .06
    CIRCLE (HJ + 25, CE + 30), NAR, 12
    NEXT NAR
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR NAR = 1 TO 50 STEP .06
    CIRCLE (HJ + 25, CE + 30), NAR, 3
    NEXT NAR
    PARA = PARA - 1
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
PARAL:
    LET HJ = X
    LET CE = Y
    DO
    PSET (HJ - 25, CE), 3
    DRAW NOPARA$
    FOR N = 1 TO 500
    NEXT N
    CE = CE + 1
    PSET (HJ - 25, CE), 3
    DRAW PARA$
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(HJ - 25, CE + 35) <> 3
'EXPLODE
    PSET (HJ - 25, CE), 3
    DRAW NOPARA$
    FOR NAR = 1 TO 50 STEP .06
    CIRCLE (HJ - 25, CE + 30), NAR, 12
    NEXT NAR
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR NAR = 1 TO 50 STEP .06
    CIRCLE (HJ - 25, CE + 30), NAR, 3
    NEXT NAR
    PARA = PARA - 1
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTB
    END
BLSCRN:
    IF BLSCRN = 0 THEN GOTO STARTA
    FOR PRO = 1 TO 3
    FOR NJ = 1 TO 200 STEP .5
    CIRCLE (320, 240), NJ, 12
    NEXT NJ
    FOR NJ = 1 TO 200 STEP .5
    CIRCLE (320, 240), NJ, 3
    NEXT NJ
    NEXT PRO
    BLSCRN = BLSCRN - 1
    GOTO STARTA
    END
STARTB:
LINE (0, 470)-(640, 481), 3, BF
COLOR 15, 3
ZEN = 8
FOR UART = 1 TO 37
CIRCLE (ZEN, 460), 10, 15, 3.8, 5.8, 1
ZEN = ZEN + 18
NEXT UART
PAINT (10, 478), 5, 15
COLOR 15,3
DRUMB:
IF FALL > 150 THEN HEL = HEL - 10: FALL = 0
IF FALLQ > 150 THEN HELQ = HELQ - 10: FALLQ = 0
COLOR 7
LOCATE 1, 57
PRINT NAM$; ":"; HEL
COLOR 9
LOCATE 2, 57
PRINT NAMQ$; ":"; HELQ
LINE (581, 0)-(640, 31), 3, BF
LINE (0, 32)-(640, 32), 15
LINE (440, 0)-(440, 32), 15
LINE (580, 0)-(580, 32), 15
LINE (0, 0)-(439, 31), 5, BF
LINE (40, 0)-(40, 32), 15
CIRCLE (20, 20), 10, 15
PAINT (20, 20), 2, 15
LINE (15, 5)-(25, 10), 7, BF
LINE (15, 5)-(25, 10), 15, B
LINE (80, 0)-(80, 32), 15
PSET (78, 15), 5
DRAW "C1 H5 L30 D10 R30 E5 L30 H5 F5 G5 R20 G10 U10 BU10 U10 F10"
LINE (120, 0)-(120, 32), 15
PSET (92, 16), 5
DRAW "C15 E15 D5 G12 E12 R5 G10 E10 U5 L5 F5 L5 E5 D5 G15 H5 L3 G5 F10 E5 H3 E2 BG5 P1,15 BU8 BR5 P2,15 BU5 P2,15"
LINE (160, 0)-(160, 32), 15
CIRCLE (140, 15), 15, 13
CIRCLE (140, 15), 13, 10, , , 2
CIRCLE (140, 15), 10, 10, , , .7
LINE (200, 0)-(200, 32), 15
CIRCLE (180, 15), 13, 15, , , 1.5
PAINT (180, 15), 13, 15
CIRCLE (180, 15), 10, 14, 2, 3, 1.5
LINE (240, 0)-(240, 32), 15
PSET (205, 13), 5
DRAW "C15 R15 D5 L15 U5 R15 E5 U5 R5 D25 L5 U5 H5 BR10 BD8 R3 U20 L3 BF1 P14,15 BL3 P12,15 BL10 BD7 P2,15"
LINE (280, 0)-(280, 32), 15
LINE (240, 15)-(260, 20), 15
LINE (260, 20)-(280, 5), 15
PAINT (250, 20), 8, 15
PSET (255, 0), 5
DRAW "C15 R10 F5 L20 E5 BD5 D8 R10 U8 D8 L3 D10 L4 U10 D10 R2 D5 F2 L4 E2 D1 BU8 P13,15 BU3 P13,15 C13 D4 L1 U4 R2 D4 BU10 P9,15 BU8 P2,15"
LINE (320, 0)-(320, 32), 15
PSET (295, 21), 5
DRAW "C15 U15 E5 F5 D15 L10 G5 D5 E5 R10 F5 U5 H5 U15 L10 BR5 BU2 P10,15 BD10 P6,15 BD10 P7,15"
LINE (360, 0)-(360, 32), 15
PSET (330, 25), 5
DRAW "C15U20R6D20L6BE2P1,15U1BR2D1BU15U1BL2D1 BR10 D10 R6 U10 L6 D10 R3 D10 BH1 U9 R2 D9 BU13 P2,15"
LINE (400, 0)-(400, 32), 15
CIRCLE (380, 12), 10, 15, -6, -9
PAINT (380, 10), 13, 15
LINE (370, 8)-(375, 25), 1
LINE (375, 25)-(380, 12), 1
LINE (390, 15)-(375, 25), 1
LINE (372, 25)-(378, 30), 8, BF
LINE (372, 25)-(378, 30), 15, B
LINE (440, 0)-(440, 32), 15
CIRCLE (420, 15), 13, 12
PSET (402, 6), 2
DRAW "C15 E5 F5 H2 L5"
HULAQ:
'IFS
IF HEL<1 AND HELQ<1 THEN GOTO DRAWGAM
IF HEL < 1 THEN GOTO RIPA
IF HELQ < 1 THEN GOTO RIPB
IF FALL > 150 THEN HEL = HEL - 10: FALL = 0: GOTO DRUMB
IF FALLQ > 150 THEN HELQ = HELQ - 10: FALLQ = 0: GOTO DRUMB
IF POINT(X + 10, Y + 22) = 3 THEN PSET (X, Y), 3: DRAW NOWORMA$: Y = Y + 1: FALL = FALL + 1: FOR N = 1 TO 500: NEXT: PSET (X, Y), 3: DRAW WORMA$: FOR N = 1 TO 500: NEXT: GOTO HULAQ
IF POINT(A + 10, B + 22) = 3 THEN PSET (A, B), 3: DRAW NOWORMB$: B = B + 1: FALLQ = FALLQ + 1: FOR N = 1 TO 500: NEXT: PSET (A, B), 3: DRAW WORMB$: FOR N = 1 TO 500: NEXT: GOTO HULAQ
FALL = 0
FALLQ = 0
IF Y>440 AND B>440 THEN GOTO DRAWGAM
IF X > 640 OR X < 0 OR Y > 440 OR Y < 0 THEN HEL = 0: PSET (X, Y), 3: DRAW NOWORMA$: GOTO WINA
IF A > 640 OR A < 0 OR B > 440 OR B < 0 THEN HELQ = 0: PSET (A, B), 3: DRAW NOWORMB$: GOTO WINB
'WEAPON DROP
IF WEP = 1 THEN GOTO CHESQ
IF PLA = 2 THEN GOTO CHESQ
RANDOMIZE TIMER
WEPA% = INT(RND * 5)
IF WEPA% = 2 THEN WEP = 1: GOTO DROPQ
CHESQ:
PLA = 2
'WEAPON CHECK
IF WEP = 0 THEN GOTO STRIKQ
FOR NLA = K% + 5 TO K% + 33
FOR NBA = W - 30 TO W + 5
IF POINT(NLA, NBA) = 4 THEN WEP = 0: GOTO RECVQ
IF POINT(NLA, NBA) = 1 THEN WEP = 0: GOTO RECBQ
IF POINT(K% + 20, W - 12) = 3 THEN WEP = 0: LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
NEXT
NEXT
'END WEAPON
STRIKQ:
'KEYS
IF TRY>10 THEN TRY=0:GOTO STARTA
IF ROCK=1 THEN ROCK=0:GOTO AQS
IF POINT(A-10,B+30)=3 THEN GOTO AQS
IF POINT(A+15,B+30)=3 THEN GOTO AQS
    IF A>X AND (A-X)<25 AND B>Y AND (B-Y)<30 THEN GOTO TAGQ
    IF A>X AND (A-X)<25 AND B<Y AND (Y-B)<30 THEN GOTO TAGQ
    IF X>A AND (X-A)<25 AND B>Y AND (B-Y)<30 THEN GOTO TAGQ
    IF X>A AND (X-A)<25 AND B<Y AND (Y-B)<30 THEN GOTO TAGQ
    IF A=X AND B>Y AND (B-Y)<30 THEN GOTO TAGQ
    IF A=X AND B<Y AND (Y-B)<30 THEN GOTO TAGQ
IF X>A THEN GOTO DIGRQ
IF X<A THEN GOTO DIGLQ
AQS:
AQ%=INT(RND*10)
IF AQ% = 0 THEN LOS$ = "USE GREEN BOMB(2P)": TRY=TRY+1:GOTO GRENQ
IF AQ% = 1 THEN LOS$ = "USE AIR STRIKE(2P)": GOTO AIRQ
IF AQ% = 2 THEN LOS$ = "USE MACHINEGUN(2P)": TRY=TRY+1:GOTO CHANQ
IF AQ% = 3 THEN LOS$ = "USE GRENADE(2P)": TRY=TRY+1:GOTO CLUSTERQ
IF AQ% = 4 THEN LOS$ = "USE DRAGON PUNCH(2P)": GOTO TAGQ
IF AQ% = 5 THEN LOS$ = "USE MULTI-MISSILE(2P)": TRY=TRY+1:GOTO MISSQ
IF AQ% = 6 THEN LOS$ = "USE TITAN BLOCK(2P)": TRY=TRY+1:GOTO BULDQ
IF AQ% = 7 THEN LOS$ = "USE DRILL(2P)": TRY=TRY+1:GOTO DUPQ
IF AQ% = 8 THEN GOTO MOVEBCK
IF AQ% = 9 THEN LOS$ = "USE TELEPORTER(2P)": TRY=TRY+1:GOTO TELEQ
'KEYS
PSET (X, Y), 0
DRAW WORMA$
PSET (A, B), 0
DRAW WORMB$
GOTO HULAQ
END
DROPQ:
W = 90
K% = 0
K% = INT(RND * 600)
DO
PSET (K% + 20, W), 3
DRAW NOWEP$
W = W + 1
FOR N = 1 TO 300
NEXT N
PSET (K% + 20, W), 3
DRAW WEP$
FOR N = 1 TO 300
NEXT N
IF W > 450 THEN LINE (K% + 5, W - 25)-(K% + 33, W + 5), 3, BF: WEP = 0:GOTO DRUMB
LOOP UNTIL POINT(K% + 20, W + 1) <> 3
GOTO DRUMB
END
RECVQ:
RANDOMIZE TIMER
KIR% = INT(RND * 7)
IF KIR% = 0 THEN KRAT$ = "AIR STRIKE": AIR = AIR + 1
IF KIR% = 1 THEN KRAT$ = "TELEPORT": TEL = TEL + 1
IF KIR% = 2 THEN KRAT$ = "GRENADE": CLUS = CLUS + 1
IF KIR% = 3 THEN KRAT$ = "PARACHUTE BOMB": PARA = PARA + 1
IF KIR% = 4 THEN KRAT$ = "MULTI-MISSILE": MISS = MISS + 1
IF KIR% = 5 THEN KRAT$ = "METAL PLATES": GIRD = GIRD + 1
IF KIR% = 6 THEN KRAT$ = "+25% HEALTH": HEL = HEL + 25
LOCATE 4, 30
COLOR 15
PRINT "YOU GOT "; KRAT$
DELAY 1.5
LOCATE 4, 30
COLOR 3
PRINT "ллллллллллллллллллллллллллллллллллллллл"
LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
IF KIR% = 6 THEN GOTO DRUMB
GOTO HULAQ
END
RECBQ:
RANDOMIZE TIMER
KIR% = INT(RND * 7)
IF KIR% = 0 THEN KRAT$ = "AIR STRIKE": AIRQ = AIRQ + 1
IF KIR% = 1 THEN KRAT$ = "TELEPORT": TELQ = TELQ + 1
IF KIR% = 2 THEN KRAT$ = "GRENADE": CLUSQ = CLUSQ + 1
IF KIR% = 3 THEN KRAT$ = "PARACHUTE BOMB": PARAQ = PARAQ + 1
IF KIR% = 4 THEN KRAT$ = "MULTI-MISSILE": MISSQ = MISSQ + 1
IF KIR% = 5 THEN KRAT$ = "METAL PLATES": GIRDQ = GIRDQ + 1
IF KIR% = 6 THEN KRAT$ = "+25% HEALTH": HELQ = HELQ + 25
LOCATE 4, 30
COLOR 15
PRINT "YOU GOT "; KRAT$
DELAY 1.5
LOCATE 4, 30
COLOR 3
PRINT "ллллллллллллллллллллллллллллллллллллллл"
LINE (K% + 5, W - 25)-(K% + 33, W), 3, BF
IF KIR% = 6 THEN GOTO DRUMB
GOTO HULAQ
END
QCONSOLE:
LINE (0, 0)-(640, 32), 16, BF
LINE (0, 32)-(640, 32), 15
COLOR 8, 0
LOCATE 1, 1
PRINT LOS$
COLOR 4
LOCATE 2, 1
INPUT "", LOS$
IF LOS$ = "Q" OR LOS$ = "q" THEN GOTO STARTB
IF LOS$ = "A" OR LOS$ = "a" THEN GOTO STARTB
IF LOS$ = "GIVE HEALTH(2P)" OR LOS$ = "give health(2p)" THEN HELQ = HELQ + 25
IF LOS$ = "GIVE FIVE(2P)" OR LOS$ = "give five(2p)" THEN CLUSQ = 5: AIRQ = 1: TELQ = 2
IF LOS$ = "GIVE MM(2P)" OR LOS$ = "give mm(2p)" THEN MISSQ = 1
IF LOS$ = "GIVE TB(2P)" OR LOS$ = "give tb(2p)" THEN GIRDQ = 2
IF LOS$ = "GIVE PA(2P)" OR LOS$ = "give pa(2p)" THEN PARAQ = 1
IF LOS$ = "MOVE=0" OR LOS$ = "move=0" THEN GOTO CONSOLE
IF LOS$ = "GM_SHOWRESOURCE" OR LOS$ = "gm_showresource" THEN LOCATE 2, 1: PRINT AIRQ; TELQ; CLUSQ; MISSQ; GIRDQ; PARAQ; BLSCRN; "                ": DO: LOOP WHILE INKEY$ = ""
IF LOS$ = "GM_QUIT" OR LOS$ = "gm_quit" THEN END
IF LOS$ = "GM_ITEMDROP" OR LOS$ = "gm_itemdrop" THEN WEP = 1: COLOR 15, 3: GOTO DROPQ
IF LOS$ = "GM_CURPOS" OR LOS$ = "gm_curpos" THEN LOCATE 2,1:PRINT"X:";A;" Y:";B:DO:LOOP WHILE INKEY$=""
IF LOS$ = "GM_KILL" OR LOS$="gm_kill" THEN HELQ=0:GOTO STARTB
IF LOS$ = "ON 'D' DROP" OR LOS$="on 'd' drop" THEN DRIPQ=1
GOTO QCONSOLE
END
DIGRQ:
IF POINT(A + 15, B - 5) <> 3 THEN ROCK=1:GOTO HULAQ
PSET (A, B), 0
DRAW NOWORMB$
FOR N = 1 TO 500
NEXT N
B = B - 1
A = A + 1
LET WORMB$=WORMBX$
LET NOWORMB$=NOWORMBX$
PSET (A, B), 0
DRAW WORMB$
FOR N = 1 TO 500
NEXT N
GOTO HULAQ
END
DIGLQ:
IF POINT(A - 5, B) <> 3 THEN ROCK=1:GOTO HULAQ
PSET (A, B), 0
DRAW NOWORMB$
FOR N = 1 TO 500
NEXT N
A = A - 1
B = B - 1
LET WORMB$=WORMBZ$
LET NOWORMB$=NOWORMBZ$
PSET (A, B), 0
DRAW WORMB$
FOR N = 1 TO 500
NEXT N
GOTO HULAQ
END
GRENQ:
IF A>X AND (A-X)>100 AND B<Y THEN GOTO THLQ
IF A<X AND (X-A)>100 AND B<Y THEN GOTO THRQ
GOTO STARTB
END
THRQ:
RG = A
RZ = B
DO
CIRCLE (RG + 17, RZ), 4, 3
PAINT (RG + 17, RZ), 3, 3
RG = RG + 1
RZ=RZ+0.25
FOR N = 1 TO 200
NEXT N
CIRCLE (RG + 17, RZ), 4, 15
PAINT (RG + 17, RZ), 2, 15
FOR N = 1 TO 200
NEXT N
IF POINT(RG + 23, RZ) <> 3 THEN GOTO EXPLQ
IF POINT(RG + 23, RZ) = 4 THEN GOTO EXPLQ
LOOP UNTIL RG > 670
ARTAQ:
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTA
END
EXPLQ:
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 12
NEXT
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 3
NEXT
GOTO ARTAQ
END
THLQ:
RG = A
RZ = B
DO
CIRCLE (RG - 17, RZ), 4, 3
PAINT (RG - 17, RZ), 3, 3
RG = RG - 1
RZ=RZ+0.25
FOR N = 1 TO 200
NEXT N
CIRCLE (RG - 17, RZ), 4, 15
PAINT (RG - 17, RZ), 2, 15
FOR N = 1 TO 200
NEXT N
IF POINT(RG - 23, RZ) <> 3 THEN GOTO EXPLAQ
IF POINT(RG - 23, RZ) = 1 THEN GOTO EXPLAQ
LOOP UNTIL RG < -70
ARTAAQ:
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTA
END
EXPLAQ:
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 12
NEXT
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
FOR N = 1 TO 40 STEP .05
CIRCLE (RG, RZ), N, 3
NEXT
GOTO ARTAAQ
END
AIRQ:
COLOR 15
LOCATE 1, 75
PRINT "AMMO"
LOCATE 2, 76
PRINT AIRQ
DELAY .5
IF AIRQ = 0 THEN GOTO STARTB
AR = 100
AG = 100
LET AR=X+5
LET AG=Y-5
GOTO ATY
DO
LINE (AR, AG)-(AR + 10, AG), POINT(AR + 1, AG - 1)
LINE (AR + 5, AG - 5)-(AR + 5, AG + 5), POINT(AR + 1, AG - 1)
FOR N = 1 TO 500
NEXT N
LET A$ = INKEY$
IF A$ = CHR$(0) + "M" THEN AR = AR + 5
IF A$ = CHR$(0) + "K" THEN AR = AR - 5
IF A$ = CHR$(0) + "H" THEN AG = AG - 5
IF A$ = CHR$(0) + "P" THEN AG = AG + 5
IF A$ = CHR$(27) THEN GOTO ARTA
LINE (AR, AG)-(AR + 10, AG), 14
LINE (AR + 5, AG - 5)-(AR + 5, AG + 5), 14
FOR N = 1 TO 500
NEXT N
LOOP UNTIL A$ = " "
ATY:
FOR NA = 1 TO 4
FOR N = 1 TO 30 STEP .05
CIRCLE (AR - 60, AG), N, 12
NEXT N
IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 25
IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 25
FOR N = 1 TO 30 STEP .05
CIRCLE (AR - 60, AG), N, 3
NEXT N
AR = AR + 60
AG = AG + 10
NEXT NA
LET AIRQ = AIRQ - 1
LOCATE 4, 1
COLOR 3
PRINT "лллллллллллллллллллллллл"
GOTO STARTA
END
CHANQ:
IF B>Y AND (B-Y)<25 THEN GOTO IOD
IF B<Y AND (Y-B)<25 THEN GOTO IOD
IF B=Y THEN GOTO IOD
IF Y<B AND A<X AND (X-A)<16 THEN LO=5:GOTO THUTQ
IF Y<B AND A>X AND (A-X)<16 THEN LO=5:GOTO THUTQ
IF Y<B AND A=X THEN LO=5:GOTO THUTQ
GOTO STARTB
END
IOD:
IF A>X THEN LO=5:GOTO THLTQ
IF A<X THEN LO=5:GOTO THRTQ
END
THRTQ:
IF LO = 0 THEN GOTO ARTAAQ
FOR AF = 1 TO 5
RG = A + 10
RZ = B
DO
RG = RG + 1
IF POINT(RG + 15, RZ) = 4 THEN GOTO EXPLTQ
IF POINT(RG + 15, RZ) <> 3 THEN NOR = 1: GOTO EXPLTQ
LOOP UNTIL RG > 670
LO = LO - 1
NEXT AF
EXPLTQ:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X - 5, Y) = 15 THEN HEL = HEL - 3
IF POINT(A + 5, B) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTRQ
PSET (X, Y), 3
DRAW NOWORMA$
X = X + 8
PSET (X, Y), 3
DRAW WORMA$
ASTRQ:
LO = LO - 1
NOR = 0
GOTO THRTQ
END
THLTQ:
IF LO = 0 THEN GOTO ARTAAQ
FOR AF = 1 TO 5
RG = A - 10
RZ = B
DO
RG = RG - 1
IF POINT(RG - 15, RZ) = 4 THEN GOTO EXPLTAQ
IF POINT(RG - 15, RZ) <> 3 THEN NOR = 1: GOTO EXPLTAQ
LOOP UNTIL RG > 670
LO = LO - 1
NEXT AF
EXPLTAQ:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X + 15, Y) = 15 THEN HEL = HEL - 3
IF POINT(A - 15, B) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTRAQ
PSET (X, Y), 3
DRAW NOWORMA$
X = X - 8
PSET (X, Y), 3
DRAW WORMA$
ASTRAQ:
LO = LO - 1
NOR = 0
GOTO THLTQ
END
THUTQ:
IF LO = 0 THEN GOTO ARTAAQ
FOR AF = 1 TO 5
RG = A
RZ = B - 10
DO
RZ = RZ - 1
IF POINT(RG, RZ - 8) = 4 THEN GOTO EXPLTAUQ
IF POINT(RG, RZ - 8) <> 3 THEN NOR = 1: GOTO EXPLTAUQ
LOOP UNTIL RZ < 0
LO = LO - 1
NEXT AF
EXPLTAUQ:
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 15
NEXT
IF POINT(X - 2, Y + 8) = 15 THEN HEL = HEL - 3
IF POINT(A - 2, B + 8) = 15 THEN HELQ = HELQ - 3
FOR N = 1 TO 12 STEP .02
CIRCLE (RG, RZ), N, 3
NEXT
IF NOR = 1 THEN GOTO ASTRAUQ
PSET (X, Y), 3
DRAW NOWORMA$
Y = Y - 8
PSET (X, Y), 3
DRAW WORMA$
ASTRAUQ:
LO = LO - 1
NOR = 0
GOTO THUTQ
END
TELEQ:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT TELQ
    DELAY .5
    IF TELQ = 0 THEN GOTO STARTB
    IF WEP=1 THEN AR=K%+10:AG=W-35:GOTO TU
    IF HELQ>21 THEN GOTO STARTB
    FOR NJA=615 TO 1 STEP-2
    FOR RJA=50 TO 479 STEP+2
    IF POINT(NJA,RJA)<>3 THEN AR=NJA:AG=RJA-50:GOTO TU
    NEXT
    NEXT
    GOTO STARTB
'TELEPORT
TU:
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NO = 1 TO 8
    FOR N = 1 TO 15 STEP .01
    CIRCLE (A + 8, B + 5), N, 10
    NEXT
    FOR N = 1 TO 15 STEP .01
    CIRCLE (A + 8, B + 5), N, 3
    NEXT
    NEXT NO
    LET A = AR
    LET B = AG
    FOR NO = 1 TO 8
    FOR N = 1 TO 15 STEP .01
    CIRCLE (A + 8, B + 5), N, 10
    NEXT
    FOR N = 1 TO 15 STEP .01
    CIRCLE (A + 8, B + 5), N, 3
    NEXT
    NEXT NO
    LET TELQ = TELQ - 1
    GOTO ARTAAQ
    END
CLUSTERQ:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT CLUSQ
    DELAY .5
    IF CLUSQ = 0 THEN GOTO STARTB
    IF X>A AND POINT(A+5,B-50)=3 THEN GOTO THRZQ
    IF X<A AND POINT(A-5,B-50)=3 THEN GOTO THLZQ
    GOTO STARTB
THRZQ:
    COLOR 3
    LOCATE 4, 1
    PRINT "лллллллллллллллллллллллл"
SEKTQ:
    LET NUMQ=(X-A)/2:GOTO LANCQ
    IF NUMQ < 1 THEN NUMQ = 1
    IF NUMQ > 200 THEN NUMQ = 200
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "H" THEN NUMQ = NUMQ + 2
    IF A$ = CHR$(0) + "P" THEN NUMQ = NUMQ - 2
    IF A$ = CHR$(27) THEN GOTO ARTA
    IF A$ = " " THEN GOTO LANCQ
    LOCATE 4, 1
    COLOR 15
    PRINT "Power( or )"; NUMQ
    GOTO SEKTQ
    END
LANCQ:
    RG = A
    RZ = B
    FOR NR = 1 TO NUMQ
    CIRCLE (RG + 17, RZ), 7, 3, , , 1.5
    PAINT (RG + 17, RZ), 3, 3
    CIRCLE (RG + 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG + 1
    RZ = RZ - 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG + 17, RZ), 7, 15, , , 1.5
    PAINT (RG + 17, RZ), 12, 15
    CIRCLE (RG + 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    IF POINT(RG + 23, RZ) <> 3 THEN GOTO EXPLZQ
    NEXT NR
    GOTO DOWNAQ
EXPLZQ:
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X - 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A + 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUSQ = CLUSQ - 1
    GOTO STARTA
    END
DOWNAQ:
    DO
    CIRCLE (RG + 17, RZ), 7, 3, , , 1.5
    PAINT (RG + 17, RZ), 3, 3
    CIRCLE (RG + 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG + 1
    RZ = RZ + 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG + 17, RZ), 7, 15, , , 1.5
    PAINT (RG + 17, RZ), 12, 15
    CIRCLE (RG + 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(RG + 23, RZ) <> 3
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X - 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A + 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUSQ = CLUSQ - 1
    GOTO STARTA
    END
THLZQ:
    COLOR 3
    LOCATE 4, 1
    PRINT "лллллллллллллллллллллллл"
SEKTZQ:
    LET NUMQ=(A-X)/2:GOTO LANCZQ
    IF NUMQ < 1 THEN NUMQ = 1
    IF NUMQ > 200 THEN NUMQ = 200
    LET A$ = INKEY$
    IF A$ = CHR$(0) + "H" THEN NUMQ = NUMQ + 2
    IF A$ = CHR$(0) + "P" THEN NUMQ = NUMQ - 2
    IF A$ = CHR$(27) THEN GOTO ARTA
    IF A$ = " " THEN GOTO LANCZQ
    LOCATE 4, 1
    COLOR 15
    PRINT "Power( or )"; NUMQ
    GOTO SEKTZQ
    END
LANCZQ:
    RG = A
    RZ = B
    FOR NR = 1 TO NUMQ
    CIRCLE (RG - 17, RZ), 7, 3, , , 1.5
    PAINT (RG - 17, RZ), 3, 3
    CIRCLE (RG - 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG - 1
    RZ = RZ - 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG - 17, RZ), 7, 15, , , 1.5
    PAINT (RG - 17, RZ), 12, 15
    CIRCLE (RG - 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    IF POINT(RG - 23, RZ) <> 3 THEN GOTO EXPLZZQ
    NEXT NR
    GOTO DOWNAZQ
EXPLZZQ:
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUSQ = CLUSQ - 1
    GOTO STARTA
    END
DOWNAZQ:
    DO
    CIRCLE (RG - 17, RZ), 7, 3, , , 1.5
    PAINT (RG - 17, RZ), 3, 3
    CIRCLE (RG - 17, RZ), 5, 3, 2, 3, 1.5
    RG = RG - 1
    RZ = RZ + 2
    FOR N = 1 TO 500
    NEXT N
    CIRCLE (RG - 17, RZ), 7, 15, , , 1.5
    PAINT (RG - 17, RZ), 12, 15
    CIRCLE (RG - 17, RZ), 5, 15, 2, 3, 1.5
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(RG - 23, RZ) <> 3
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 12
    NEXT
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 20
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 20
    FOR N = 1 TO 50 STEP .05
    CIRCLE (RG, RZ), N, 3
    NEXT
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллллллллллллл"
    LET CLUSQ = CLUSQ - 1
    GOTO STARTA
    END
TAGQ:
    IF A>X AND (A-X)<25 AND B>Y AND (B-Y)<30 THEN GOTO TAGLQ
    IF A>X AND (A-X)<25 AND B<Y AND (Y-B)<30 THEN GOTO TAGLQ
    IF X>A AND (X-A)<25 AND B>Y AND (B-Y)<30 THEN GOTO TAGRQ
    IF X>A AND (X-A)<25 AND B<Y AND (Y-B)<30 THEN GOTO TAGRQ
    IF A=X AND B>Y AND (B-Y)<30 THEN GOTO TAGRQ
    IF A=X AND B<Y AND (Y-B)<30 THEN GOTO TAGRQ
    GOTO STARTB
    IF A$ = CHR$(0) + "M" THEN GOTO TAGRQ
    IF A$ = CHR$(0) + "K" THEN GOTO TAGLQ
    IF A$ = CHR$(27) THEN GOTO ARTA
    GOTO TAGQ
    END
TAGRQ:
    FOR NRS = A - 13 TO A + 25
    FOR NMS = B - 18 TO B + 25
    IF POINT(NRS, NMS) = 4 THEN GOTO TAGITQ
    NEXT
    NEXT
'DAMN IT
    FOR STAS = 1 TO 30
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    B = B - 1
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
'DAMN IT
TAGITQ:
    FOR STAS = 1 TO 30
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    B = B - 1
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
'WORMDAMAGE
    FOR STAS = 1 TO 90
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    X = X + 1
    Y = Y - .5
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LET HEL = HEL - 10
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
TAGLQ:
    FOR NRS = A - 13 TO A + 25
    FOR NMS = B - 18 TO B + 25
    IF POINT(NRS, NMS) = 4 THEN GOTO TAGITZQ
    NEXT
    NEXT
'DAMN IT
    FOR STAS = 1 TO 30
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    B = B - 1
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
'DAMN IT
TAGITZQ:
    FOR STAS = 1 TO 30
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    B = B - 1
    PSET (A, B), 3
    DRAW WORMB$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
'WORMDAMAGE
    FOR STAS = 1 TO 90
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    X = X - 1
    Y = Y - .5
    PSET (X, Y), 3
    DRAW WORMA$
    FOR NRA = 1 TO 500
    NEXT NRA
    NEXT STAS
    LET HEL = HEL - 10
    COLOR 3
    LOCATE 4, 1
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
DUPQ:
    IF Y>B AND (Y-B)>50 AND POINT(A,B+100)<>3 THEN GOTO RA
    GOTO STARTB
RA:
    RF = A
    RM = B
    FOR N = 1 TO 170
    PSET (RF, RM + 12), 3
    DRAW "C3"
    DRAW DRILL$
    PSET (A, B), 3
    DRAW "TA0"
    DRAW NOWORMB$
    FOR NA = 1 TO 1000
    NEXT NA
    RM = RM + 1
    B = B + 1
    PSET (RF, RM + 12), 3
    DRAW "C15"
    DRAW DRILL$
    PSET (A, B), 3
    DRAW "TA0"
    DRAW WORMB$
    FOR NA = 1 TO 1000
    NEXT NA
    IF Y=B+20 THEN GOTO STPXQ
    NEXT N
STPXQ:
    PSET (RF, RM + 12), 3
    DRAW "C3"
    DRAW DRILL$
    DRAW "TA0"
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
MISSQ:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT MISSQ
    DELAY .5
    IF MISSQ = 0 THEN GOTO STARTB
    IF Y<B THEN POWQ=B-Y:GOTO ADFG
    GOTO STARTB
ADFG:
    QW = A
    WR = B
'ATTACK
    FOR POK = 1 TO POWQ
    PSET (QW, WR - 15), 3
    DRAW NOMISS$
    FOR NM = 1 TO 250
    NEXT NM
    WR = WR - 1.5
    PSET (QW, WR - 15), 3
    DRAW MISS$
    FOR NM = 1 TO 250
    NEXT NM
    IF POINT(QW + 5, WR - 30) <> 3 THEN GOTO BOOMQ
    NEXT POK
BOOMQ:
    PSET (QW, WR - 15), 3
    DRAW NOMISS$
'CABOOM
    ZO = QW
    DF = WR
    DO
    FOR N = 1 TO 35 STEP .05
    CIRCLE (QW - 15, WR), N, 12
    NEXT N
    FOR N = 1 TO 35 STEP .05
    CIRCLE (ZO + 15, DF), N, 12
    NEXT N
    IF POINT(X + 5, Y) = 12 THEN HEL = HEL - 23
    IF POINT(A - 5, B) = 12 THEN HELQ = HELQ - 23
    FOR N = 1 TO 35 STEP .05
    CIRCLE (QW - 15, WR), N, 3
    NEXT N
    FOR N = 1 TO 35 STEP .05
    CIRCLE (ZO + 15, DF), N, 3
    NEXT N
    QW = QW - 60
    ZO = ZO + 60
    LOOP UNTIL ZO > 640 AND QW < 0
'FINISH ATTACK
    MISSQ = MISSQ - 1
    LOCATE 4, 1
    COLOR 3
    PRINT "лллллллллллллллллллллллл"
    GOTO STARTA
    END
BULDQ:
    COLOR 15
    LOCATE 1, 75
    PRINT "AMMO"
    LOCATE 2, 76
    PRINT GIRDQ
    DELAY .5
    IF GIRDQ = 0 THEN GOTO STARTB
    IF A>X THEN AR=X+18:AG=Y-50:GOTO BKL
    IF A<X THEN AR=X-18:AG=Y-50:GOTO BKL
    GOTO STARTB
BKL:
'START BUILDING
    CIRCLE (AR, AG), 2, 3
    LINE (AR, AG)-(AR + 20, AG + 100), 9, BF
    LINE (AR, AG)-(AR + 20, AG + 100), 15, B
    FOR TG = 1 TO 1
    CIRCLE (AR + 5, AG + 5), TG, 8
    PSET (AR + 5, AG + 5), 8
    CIRCLE (AR + 15, AG + 5), TG, 8
    PSET (AR + 15, AG + 5), 8
    CIRCLE (AR + 5, AG + 95), TG, 8
    PSET (AR + 5, AG + 95), 8
    CIRCLE (AR + 15, AG + 95), TG, 8
    PSET (AR + 15, AG + 95), 8
    NEXT TG
    GIRDQ = GIRDQ - 1
    LOCATE 4, 1
    COLOR 3
    PRINT "ллллллллллллллллллллллллллллллллл"
    GOTO STARTA
    END
MOVEBCK:
IF HEL<1 AND HELQ<1 THEN GOTO DRAWGAM
IF HEL < 1 THEN GOTO RIPA
IF HELQ < 1 THEN GOTO RIPB
IF FALL > 150 THEN HEL = HEL - 10: FALL = 0: GOTO DRUMB
IF FALLQ > 150 THEN HELQ = HELQ - 10: FALLQ = 0: GOTO DRUMB
IF POINT(X + 10, Y + 22) = 3 THEN PSET (X, Y), 3: DRAW NOWORMA$: Y = Y + 1: FALL = FALL + 1: FOR N = 1 TO 500: NEXT: PSET (X, Y), 3: DRAW WORMA$: FOR N = 1 TO 500: NEXT: GOTO MOVEBCK
IF POINT(A + 10, B + 22) = 3 THEN PSET (A, B), 3: DRAW NOWORMB$: B = B + 1: FALLQ = FALLQ + 1: FOR N = 1 TO 500: NEXT: PSET (A, B), 3: DRAW WORMB$: FOR N = 1 TO 500: NEXT: GOTO MOVEBCK
FALL = 0
FALLQ = 0
IF Y>440 AND B>440 THEN GOTO DRAWGAM
IF X > 640 OR X < 0 OR Y > 440 OR Y < 0 THEN HEL = 0: PSET (X, Y), 3: DRAW NOWORMA$: GOTO WINA
IF A > 640 OR A < 0 OR B > 440 OR B < 0 THEN HELQ = 0: PSET (A, B), 3: DRAW NOWORMB$: GOTO WINB
    IF X>A THEN GOTO LEF
    IF X<A THEN GOTO RIGH
    GOTO STARTB
    END
LEF:
IF POINT(A-20,B+40)=3 THEN ROCK=1:GOTO AQS
IF POINT(A - 5, B) <> 3 THEN ROCK=1:GOTO AQS
PSET (A, B), 0
DRAW NOWORMB$
FOR N = 1 TO 500
NEXT N
A = A - 1
B = B - 1
LET WORMB$=WORMBZ$
LET NOWORMB$=NOWORMBZ$
PSET (A, B), 0
DRAW WORMB$
FOR N = 1 TO 500
NEXT N
GOTO MOVEBCK
END
RIGH:
IF POINT(A+20,B+40)=3 THEN ROCK=1:GOTO AQS
IF POINT(A + 15, B - 5) <> 3 THEN ROCK=1:GOTO AQS
PSET (A, B), 0
DRAW NOWORMB$
FOR N = 1 TO 500
NEXT N
B = B - 1
A = A + 1
LET WORMB$=WORMBX$
LET NOWORMB$=NOWORMBX$
PSET (A, B), 0
DRAW WORMB$
FOR N = 1 TO 500
NEXT N
GOTO MOVEBCK
END
WINA:
    COLOR 4
    LOCATE 4, 30
    PRINT NAMQ$; " WINS THE GAME!"
    DELAY 2.5
    END
WINB:
    COLOR 4
    LOCATE 4, 30
    PRINT NAM$; " WINS THE GAME!"
    DELAY 2.5
    END
RIPA:
    PSET (X, Y), 3
    DRAW NOWORMA$
    FOR FA = 1 TO 40
    PSET (X, Y + 25), 3
    DRAW NORIP$
    FOR N = 1 TO 500
    NEXT N
    Y = Y - 1
    PSET (X, Y + 25), 3
    DRAW RIP$
    FOR N = 1 TO 500
    NEXT N
    NEXT FA
    DO
    PSET (X, Y + 25), 3
    DRAW NORIP$
    FOR N = 1 TO 500
    NEXT N
    Y = Y + 1
    PSET (X, Y + 25), 3
    DRAW RIP$
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(X + 5, Y + 26) <> 3
    DELAY .5
    GOTO WINA
    END
RIPB:
    PSET (A, B), 3
    DRAW NOWORMB$
    FOR FA = 1 TO 40
    PSET (A, B + 25), 3
    DRAW NORIP$
    FOR N = 1 TO 500
    NEXT N
    B = B - 1
    PSET (A, B + 25), 3
    DRAW RIP$
    FOR N = 1 TO 500
    NEXT N
    NEXT FA
    DO
    PSET (A, B + 25), 3
    DRAW NORIP$
    FOR N = 1 TO 500
    NEXT N
    B = B + 1
    PSET (A, B + 25), 3
    DRAW RIP$
    FOR N = 1 TO 500
    NEXT N
    LOOP UNTIL POINT(A + 5, B + 26) <> 3
    DELAY .5
    GOTO WINB
    END
DRAWGAM:
    COLOR 4
    LOCATE 4, 35
    PRINT "DRAW GAME!"
    DELAY 2.5
    END
RUNNER:
COLOR 4
LOCATE 4,25
PRINT"Do you really want to quit ?(Y/N)"
LET A$=INKEY$
IF A$="Y" OR A$="y" THEN END
IF A$="N" OR A$="n" THEN LOCATE 4,25:COLOR 3:PRINT"ллллллллллллллллллллллллллллллллл":RETURN
GOTO RUNNER
END
















