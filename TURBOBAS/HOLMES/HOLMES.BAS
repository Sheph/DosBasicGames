   IF COMMAND$="/?" OR COMMAND$="-?" THEN CLS:GOTO ASKME
   IF UCASE$(COMMAND$)="/QUICK" THEN QUICK=1
   IF UCASE$(COMMAND$)="/NEW" THEN NEWG=1
   IF UCASE$(COMMAND$)="/HELP" THEN HELPG=1
   CLS
   ON ERROR GOTO NOFILE
   OPEN"HOLMES.DAT" FOR INPUT AS #1
   ON ERROR GOTO NOFILE
   INPUT #1,SCR%,PALA%,SND$,GRA$,PAL$
   ON ERROR GOTO NOFILE
   CLOSE
   IF PALA%=1 THEN GOSUB PALTA
   IF PALA%=2 THEN GOSUB PALTB
'PRIMAL DATA
   SCREEN SCR%
'‡‚“‚€ €’€ DATA
DIM sfx$(30)
c$(0) = "&hB0&h20&h23&h40&h43&h60&h63&h80&h83&hA0&HBD&HC0&HE0&HE3&hB0"
c$(1) = "&hB1&h21&h24&h41&h44&h61&h64&h81&h84&hA1&HBD&HC1&HE1&HE4&hB1"
c$(2) = "&hB2&h22&h25&h42&h45&h62&h65&h82&h85&hA2&HBD&HC2&HE2&HE5&hB2"
c$(3) = "&hB3&h28&h2B&h48&h4B&h68&h6B&h88&h8B&hA3&HBD&HC3&HE8&HEB&hB3"
c$(4) = "&hB4&h29&h2C&h49&h4C&h69&h6C&h89&h8C&hA4&HBD&HC4&HE9&HEC&hB4"
c$(5) = "&hB5&h2A&h2D&h4A&h4D&h6A&h6D&h8A&h8D&hA5&HBD&HC5&HEA&HED&hB5"
c$(6) = "&hB6&h30&h33&h50&h53&h70&h73&h90&h93&hA6&HBD&HC6&HF0&HF3&hB6"
c$(7) = "&hB7&h31&h34&h51&h54&h71&h74&h91&h94&hA7&HBD&HC7&HF1&HF4&hB7"
c$(8) = "&hB8&h32&h35&h52&h55&h72&h75&h92&h95&hA8&HBD&HC8&HF2&HF5&hB8"
c$ = "&hB8&h32&h35&h52&h55&h72&h75&h92&h95&hA8&HBD&HC8&HF2&HF5&hB8"
sfx$(1) = "&H00&H00&H00&H90&CB0&H00&HF0&H10&H09&H00&H05&H0A&H00&H00&HF0&H1"
sfx$(4) = "&H00&H80&H00&H00&H00&HF0&HB9&HA2&H04&H89&HC0&H0E&H00&H00&H20&H1"
sfx$(22) = "&H00&H00&H00&H00&H1E&H55&H88&H5B&H2F&H00&HC0&H07&H03&H00&H2E&H0"
sfx$(10)="&H00&H04&H00&H00&H00&H85&H00&HCF&H00&HFF&HC0&H09&H01&H00&H33&H0"
sfx$(14)="&H00&H00&H00&H03&H00&HA3&H54&HA5&HA6&HDC&HC0&H00&H00&H00&H27&H0"
'MASSIVES
   DIM MAIN(3000)
   DIM NEWGAME(1000)
   DIM HELP(1000)
   DIM OPTIONS(1000)
   DIM QUIT(1000)
   DIM MAINOPT(3700)
   DIM MAINHELP(5000)
   DIM OFAUTORS(5000)
   DIM OFMISS(5000)
   DIM OFGAME(5000)
   DIM FONT(12000)
   DIM WHO(10000)
   DIM YEAR(5000)
'DEFINE SEGMENTS,OPEN
   DEF SEG=VARSEG(MAIN(0))
   BLOAD"MAINMENU.HMS",VARPTR(MAIN(0))
   DEF SEG=VARSEG(NEWGAME(0))
   BLOAD"NEWGAME.HMS",VARPTR(NEWGAME(0))
   DEF SEG=VARSEG(HELP(0))
   BLOAD"HELP.HMS",VARPTR(HELP(0))
   DEF SEG=VARSEG(OPTIONS(0))
   BLOAD"OPTIONS.HMS",VARPTR(OPTIONS(0))
   DEF SEG=VARSEG(QUIT(0))
   BLOAD"QUIT.HMS",VARPTR(QUIT(0))
   DEF SEG=VARSEG(MAINOPT(0))
   BLOAD"MAINOPT.HMS",VARPTR(MAINOPT(0))
   DEF SEG=VARSEG(MAINHELP(0))
   BLOAD"MAINHELP.HMS",VARPTR(MAINHELP(0))
   DEF SEG=VARSEG(OFAUTORS(0))
   BLOAD"OFAUTORS.HMS",VARPTR(OFAUTORS(0))
   DEF SEG=VARSEG(OFMISS(0))
   BLOAD"OFMISS.HMS",VARPTR(OFMISS(0))
   DEF SEG=VARSEG(OFGAME(0))
   BLOAD"OFGAME.HMS",VARPTR(OFGAME(0))
   DEF SEG=VARSEG(YEAR(0))
   BLOAD"YEAR.HMS",VARPTR(YEAR(0))
   DEF SEG=VARSEG(WHO(0))
   BLOAD"CREATED.HMS",VARPTR(WHO(0))
   DEF SEG=VARSEG(FONT(0))
   BLOAD"INSCRIPT.HMS",VARPTR(FONT(0))
'DEFINE SEGMENTS,OPEN
   IF QUICK=1 THEN GOTO NORFR
   IF NEWG=1 THEN GOTO NEWGAME
   IF HELPG=1 THEN GOTO HELP
   N=0
   Z=440
   C=430
   PAINT(1,1),4,15
   DO
   PUT(25,N),FONT,PSET
   N=N+2
   LOOP UNTIL N>150
   DO
   PUT(1,Z),WHO,PSET
   Z=Z-2
   LOOP UNTIL Z<290
   DO
   PUT(220,C),YEAR,PSET
   C=C-1
   LOOP UNTIL C<325
   DELAY 2
   COLOR 15,2
   RANDOMIZE TIMER
   N=10
   M=10
   J=5
   K=5
   FOR A=1 TO 550
   X%=RND*N
   Y%=RND*M
   LINE(X%-K,Y%-K)-(X%+J,Y%+J),0,BF
   N=N+1
   M=M+3
   J=J+0.3
   K=K+0.3
   FOR PO=1 TO 300
   NEXT PO
   NEXT
   ERASE YEAR
   ERASE WHO
   ERASE FONT
NORFR:
   CLS
   COLOR 15,0
   LINE(0,70)-(640,70),15
   PAINT(1,1),1,15
   PAINT(1,479),2,15
   PUT(235,5),MAIN,PSET
   FOR X.COR=0 TO 640 STEP+2
   FOR Y.COR=0 TO 70 STEP+2
   IF POINT(X.COR,Y.COR)=1 THEN PSET(X.COR,Y.COR),9
   NEXT
   NEXT
START:
A:
   PUT(280,200),NEWGAME,PRESET
   PUT(297,230),HELP,PSET
   PUT(301,260),OPTIONS,PSET
   PUT(302,290),QUIT,PSET
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO B
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO D
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:GOTO NEWGAME
   GOTO A
   END
B:
   PUT(280,200),NEWGAME,PSET
   PUT(297,230),HELP,PRESET
   PUT(301,260),OPTIONS,PSET
   PUT(302,290),QUIT,PSET
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO C
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO A
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:GOTO HELP
   GOTO B
   END
C:
   PUT(280,200),NEWGAME,PSET
   PUT(297,230),HELP,PSET
   PUT(301,260),OPTIONS,PRESET
   PUT(302,290),QUIT,PSET
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO D
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO B
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER: GOTO OPTIONS
   GOTO C
   END
D:
   PUT(280,200),NEWGAME,PSET
   PUT(297,230),HELP,PSET
   PUT(301,260),OPTIONS,PSET
   PUT(302,290),QUIT,PRESET
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO A
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO C
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:CLS:COLOR 15,0:SCREEN 0:PRINT"‘€‘ —’ ƒ€‹ ‚ HOLMES":END
   GOTO D
   END
ASKME:
   PRINT"/? - β  ―®¬®ιμ"
   PRINT"/QUICK - ‡ ―γα ΅¥§ § αβ Ά¨"
   PRINT"/NEW - ‘ΰ §γ ­®Ά ο ¨£ΰ "
   PRINT"/HELP - ‘ΰ §γ ―®¬®ιμ"
   END
NOFILE:
   CLS
   PRINT"Cannot find file: HOLMES.DAT Please run SETUP.EXE"
   END
BLASTER:
   IF SND$="…‡ ‡‚“‚" THEN RETURN
   chan% = VAL(MID$(sfx$(snd), 61, 4))
   FOR in = 1 TO 60 STEP 4
   rega$ = MID$(c$(chan%), in, 4): rega% = VAL(rega$)
   dat$ = MID$(sfx$(snd), in, 4): dat% = VAL(dat$)
   OUT &H388, rega%: FOR d% = 1 TO 6: b% = INP(&H388): NEXT
   OUT &H389, dat%: FOR d% = 1 TO 35: b% = INP(&H388): NEXT
   NEXT
   RETURN
   END
PALTA:
   PALETTE 0,7
   PALETTE 1,0
   PALETTE 2,7
   PALETTE 3,7
   PALETTE 4,15
   PALETTE 5,15
   PALETTE 6,7
   PALETTE 7,0
   PALETTE 8,0
   PALETTE 9,7
   PALETTE 10,7
   PALETTE 11,0
   PALETTE 12,7
   PALETTE 13,0
   PALETTE 14,15
   PALETTE 15,15
   RETURN
   END
PALTB:
   PALETTE 0,0
   PALETTE 1,15
   PALETTE 2,14
   PALETTE 3,13
   PALETTE 4,12
   PALETTE 5,11
   PALETTE 6,10
   PALETTE 7,9
   PALETTE 8,8
   PALETTE 9,7
   PALETTE 10,6
   PALETTE 11,5
   PALETTE 12,4
   PALETTE 13,3
   PALETTE 14,2
   PALETTE 15,1
   RETURN
   END
PALTC:
   PALETTE
   RETURN
   END
OPTIONS:
   CLS
   LINE(0,70)-(640,70),15
   PAINT(1,1),2,15
   COLOR 15,8
   PUT(205,1),MAINOPT,PSET
   FOR X.COR=0 TO 640 STEP+2
   FOR Y.COR=0 TO 70 STEP+2
   IF POINT(X.COR,Y.COR)=2 THEN PSET(X.COR,Y.COR),1
   NEXT
   NEXT
OPA:
   COLOR 12
   LOCATE 13,28
   PRINT"‡‚“‚›… ””…’›:";SND$;"       "
   COLOR 13
   LOCATE 15,28
   PRINT"€‹’€:";PAL$;"         "
   LOCATE 17,28
   PRINT"ƒ€”—…‘‰ …†:";GRA$;"        "
   LOCATE 19,28
   PRINT"‚‡‚€’ ‚ ƒ‹€‚… …"
   LET A$=INKEY$
   IF A$=CHR$(13) AND DFN%=0 THEN SND=22:GOSUB BLASTER:SND$="…‡ ‡‚“‚":DFN%=1:GOTO OPA
   IF A$=CHR$(13) AND DFN%=1 THEN SND=22:GOSUB BLASTER:SND$="‡‚“‚€ €’€":DFN%=0:GOTO OPA
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO OPB
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO OPD
   FOR PAUS=1 TO 1000
   NEXT
   GOTO OPA
   END
OPB:
   COLOR 13
   LOCATE 13,28
   PRINT"‡‚“‚›… ””…’›:";SND$;"       "
   COLOR 12
   LOCATE 15,28
   PRINT"€‹’€:";PAL$;"         "
   COLOR 13
   LOCATE 17,28
   PRINT"ƒ€”—…‘‰ …†:";GRA$;"        "
   LOCATE 19,28
   PRINT"‚‡‚€’ ‚ ƒ‹€‚… …"
   LET A$=INKEY$
   IF A$=CHR$(13) AND PALA%=0 THEN SND=22:GOSUB BLASTER:PAL$="—…-…‹€":PALA%=1:GOSUB PALTA:GOTO OPB
   IF A$=CHR$(13) AND PALA%=1 THEN SND=22:GOSUB BLASTER:PAL$="“’‰ ":PALA%=2:GOSUB PALTB:GOTO OPB
   IF A$=CHR$(13) AND PALA%=2 THEN SND=22:GOSUB BLASTER:PAL$="‘’€„€’€":PALA%=0:GOSUB PALTC:GOTO OPB
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO OPC
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO OPA
   FOR PAUS=1 TO 1000
   NEXT
   GOTO OPB
   END
OPC:
   COLOR 13
   LOCATE 13,28
   PRINT"‡‚“‚›… ””…’›:";SND$;"       "
   LOCATE 15,28
   PRINT"€‹’€:";PAL$;"         "
   COLOR 12
   LOCATE 17,28
   PRINT"ƒ€”—…‘‰ …†:";GRA$;"        "
   COLOR 13
   LOCATE 19,28
   PRINT"‚‡‚€’ ‚ ƒ‹€‚… …"
   LET A$=INKEY$
   IF A$=CHR$(13) AND GRP%=0 THEN SND=22:GOSUB BLASTER:SCR%=9:SCREEN SCR%:GRP%=1:GRA$="640X350 VGA":GOTO OPTIONS
   IF A$=CHR$(13) AND GRP%=1 THEN SND=22:GOSUB BLASTER:SCR%=11:SCREEN SCR%:GRP%=2:GRA$="640X480 CGA":GOTO OPTIONS
   IF A$=CHR$(13) AND GRP%=2 THEN SND=22:GOSUB BLASTER:SCR%=12:SCREEN SCR%:GRP%=0:GRA$="640X480 VGA":GOTO OPTIONS
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO OPD
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO OPB
   FOR PAUS=1 TO 1000
   NEXT
   GOTO OPC
   END
OPD:
   COLOR 13
   LOCATE 13,28
   PRINT"‡‚“‚›… ””…’›:";SND$;"       "
   LOCATE 15,28
   PRINT"€‹’€:";PAL$;"         "
   LOCATE 17,28
   PRINT"ƒ€”—…‘‰ …†:";GRA$;"        "
   LOCATE 19,28
   COLOR 12
   PRINT"‚‡‚€’ ‚ ƒ‹€‚… …"
   LET A$=INKEY$
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:GOTO RECORD
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:GOTO OPA
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:GOTO OPC
   FOR PAUS=1 TO 1000
   NEXT
   GOTO OPD
   END
RECORD:
   OPEN"HOLMES.DAT" FOR OUTPUT AS #1
   WRITE #1,SCR%,PALA%,SND$,GRA$,PAL$
   CLOSE
   GOTO NORFR
   END
NEWGAME:
   CLS
   RUN"NEW.GAM"
   END
HELP:
   MJ=5
   CLS
   SND=14:GOSUB BLASTER
   PAINT(1,1),7,15
   CIRCLE(50,50),40,15,1.5,3
   CIRCLE(-12,240),200,15,4.94,1.35,2
   CIRCLE(50,430),40,15,3.25,4.75
   CIRCLE(318,470),265,15,,,0.3
   LINE(0,471)-(640,479),7,BF
   CIRCLE(590,430),40,15,4.53,0
   CIRCLE(653,235),200,15,,,2
   LINE(632,0)-(640,480),7,BF
   CIRCLE(592,50),40,15,0.22,1.6
   CIRCLE(322,10),269,15,,,0.3
   LINE(0,0)-(640,9),7,BF
   PAINT(320,240),2,15
   PUT(200,200),MAINHELP,PSET
   FOR X.CORD=1 TO 640 STEP+4
   FOR Y.CORD=1 TO 480 STEP+4
   IF POINT(X.CORD,Y.CORD)=7 THEN PSET(X.CORD,Y.CORD),8
   NEXT
   NEXT
   DELAY 2
   FOR I = 1 TO 5000
   X% = INT(RND * 640)
   Y% = INT(RND * 480)
   Z% = INT(RND * 20)
   IF Z%=10 THEN SND=1:GOSUB BLASTER
   LINE (X%, Y%)-(X% + MJ, Y% + MJ), 0, BF
   MJ=MJ+0.005
   NEXT
   MJ=5
   FOR I = 1 TO 5000
   X% = INT(RND * 640)
   Y% = INT(RND * 480)
   Z% = INT(RND * 20)
   IF Z%=10 THEN SND=1:GOSUB BLASTER
   LINE (X%, Y%)-(X% + MJ, Y% + MJ), 2, BF
   MJ=MJ+0.005
   NEXT
   LINE(0,0)-(640,480),2,BF
HELPA:
   PUT(120,100),OFAUTORS,PSET
   PUT(140,200),OFMISS,AND
   PUT(195,300),OFGAME,AND
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPB
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPC
   IF A$=CHR$(27) THEN SND=4:GOSUB BLASTER:GOTO NORFR
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:END
   GOTO HELPA
   END
HELPB:
   PUT(120,100),OFAUTORS,AND
   PUT(140,200),OFMISS,PSET
   PUT(195,300),OFGAME,AND
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPC
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPA
   IF A$=CHR$(27) THEN SND=4:GOSUB BLASTER:GOTO NORFR
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:END
   GOTO HELPB
   END
HELPC:
   PUT(120,100),OFAUTORS,AND
   PUT(140,200),OFMISS,AND
   PUT(195,300),OFGAME,PSET
   LET A$=INKEY$
   IF A$=CHR$(0)+"P" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPA
   IF A$=CHR$(0)+"H" THEN SND=1:GOSUB BLASTER:LINE(0,0)-(640,480),2,BF:GOTO HELPB
   IF A$=CHR$(27) THEN SND=4:GOSUB BLASTER:GOTO NORFR
   IF A$=CHR$(13) THEN SND=22:GOSUB BLASTER:END
   GOTO HELPC
   END










