   DECLARE SUB DRAWLEVEL ()
   DECLARE SUB NOENEMY ()
   DECLARE SUB E1 ()
   DECLARE SUB E2 ()
   DECLARE SUB VICTORY ()
   DECLARE SUB PASSWORD ()
   COMMON SHARED B$, A$, LEND(), POWER, LIFE, FLYSTEP, SCENE, ENEMY, X, Y, A, B, EXPOT, ENEMY1(), ENEMY2(), ENEMY(), PLANE(), SPRITE0(), SPRITE1(), SPRITE2()
   COMMON SHARED SPRITE3(), SPRITE4(), SPRITE5(), SPRITE6(), SPRITE7(), SPRITE8(), SPRITE9(), SPRITE10(), SPRITE11()
   COMMON SHARED SPRITE12(), SPRITE13(), SPRITE14(), SPRITE15(), SPRITE16(), SPRITE17(), SPRITE18(), SPRITE19(), SPRITE23(), SPRITE24(), SPRITE26(), SPRITE27(), SPRITE28()
   COMMON SHARED SPRITE29()
   RANDOMIZE TIMER
   SCREEN 9, , 1, 0
   COLOR 15, 3
'ARRAYS
   DIM LEND(800)
   DIM PLANE(250)
   DIM ENEMY1(250)
   DIM ENEMY2(250)
   DIM ENEMY(250)
   DIM SPRITE0(300)
   DIM SPRITE1(1550)
   DIM SPRITE2(500)
   DIM SPRITE3(270)
   DIM SPRITE4(1800)
   DIM SPRITE5(500)
   DIM SPRITE6(350)
   DIM SPRITE7(2100)
   DIM SPRITE8(1700)
   DIM SPRITE9(500)
   DIM SPRITE10(200)
   DIM SPRITE11(200)
   DIM SPRITE12(500)
   DIM SPRITE13(500)
   DIM SPRITE14(650)
   DIM SPRITE15(2000)
   DIM SPRITE16(250)
   DIM SPRITE17(500)
   DIM SPRITE18(500)
   DIM SPRITE19(500)
   DIM SPRITE23(100)
   DIM SPRITE24(350)
   DIM SPRITE26(350)
   DIM SPRITE27(250)
   DIM SPRITE28(200)
   DIM SPRITE29(200)
'OPEN FILE
   DEF SEG = VARSEG(LEND(0))
   BLOAD "LEND.SPR", VARPTR(LEND(0))
   DEF SEG = VARSEG(PLANE(0))
   BLOAD "PLANE.SPR", VARPTR(PLANE(0))
   DEF SEG = VARSEG(ENEMY1(0))
   BLOAD "ENEMY.SPR", VARPTR(ENEMY1(0))
   DEF SEG = VARSEG(ENEMY2(0))
   BLOAD "ENEMY2.SPR", VARPTR(ENEMY2(0))
   DEF SEG = VARSEG(SPRITE0(0))
   BLOAD "SPRITE0.SPR", VARPTR(SPRITE0(0))
   DEF SEG = VARSEG(SPRITE1(0))
   BLOAD "SPRITE1.SPR", VARPTR(SPRITE1(0))
   DEF SEG = VARSEG(SPRITE2(0))
   BLOAD "SPRITE2.SPR", VARPTR(SPRITE2(0))
   DEF SEG = VARSEG(SPRITE3(0))
   BLOAD "SPRITE3.SPR", VARPTR(SPRITE3(0))
   DEF SEG = VARSEG(SPRITE4(0))
   BLOAD "SPRITE4.SPR", VARPTR(SPRITE4(0))
   DEF SEG = VARSEG(SPRITE5(0))
   BLOAD "SPRITE5.SPR", VARPTR(SPRITE5(0))
   DEF SEG = VARSEG(SPRITE6(0))
   BLOAD "SPRITE6.SPR", VARPTR(SPRITE6(0))
   DEF SEG = VARSEG(SPRITE7(0))
   BLOAD "SPRITE7.SPR", VARPTR(SPRITE7(0))
   DEF SEG = VARSEG(SPRITE8(0))
   BLOAD "SPRITE8.SPR", VARPTR(SPRITE8(0))
   DEF SEG = VARSEG(SPRITE9(0))
   BLOAD "SPRITE9.SPR", VARPTR(SPRITE9(0))
   DEF SEG = VARSEG(SPRITE10(0))
   BLOAD "SPRITE10.SPR", VARPTR(SPRITE10(0))
   DEF SEG = VARSEG(SPRITE11(0))
   BLOAD "SPRITE11.SPR", VARPTR(SPRITE11(0))
   DEF SEG = VARSEG(SPRITE12(0))
   BLOAD "SPRITE12.SPR", VARPTR(SPRITE12(0))
   DEF SEG = VARSEG(SPRITE13(0))
   BLOAD "SPRITE13.SPR", VARPTR(SPRITE13(0))
   DEF SEG = VARSEG(SPRITE14(0))
   BLOAD "SPRITE14.SPR", VARPTR(SPRITE14(0))
   DEF SEG = VARSEG(SPRITE15(0))
   BLOAD "SPRITE15.SPR", VARPTR(SPRITE15(0))
   DEF SEG = VARSEG(SPRITE16(0))
   BLOAD "SPRITE16.SPR", VARPTR(SPRITE16(0))
   DEF SEG = VARSEG(SPRITE17(0))
   BLOAD "SPRITE17.SPR", VARPTR(SPRITE17(0))
   DEF SEG = VARSEG(SPRITE18(0))
   BLOAD "SPRITE18.SPR", VARPTR(SPRITE18(0))
   DEF SEG = VARSEG(SPRITE19(0))
   BLOAD "SPRITE19.SPR", VARPTR(SPRITE19(0))
   DEF SEG = VARSEG(SPRITE23(0))
   BLOAD "SPRITE23.SPR", VARPTR(SPRITE23(0))
   DEF SEG = VARSEG(SPRITE24(0))
   BLOAD "SPRITE24.SPR", VARPTR(SPRITE24(0))
   DEF SEG = VARSEG(SPRITE26(0))
   BLOAD "SPRITE26.SPR", VARPTR(SPRITE26(0))
   DEF SEG = VARSEG(SPRITE27(0))
   BLOAD "SPRITE27.SPR", VARPTR(SPRITE27(0))
   DEF SEG = VARSEG(SPRITE28(0))
   BLOAD "SPRITE28.SPR", VARPTR(SPRITE28(0))
   DEF SEG = VARSEG(SPRITE29(0))
   BLOAD "SPRITE29.SPR", VARPTR(SPRITE29(0))
'VARIABLES
   POWER = 0
   FLYSTEP = 2.5 / 5.0
   LIFE = 5
   SCENE = 1
   EK = 0
BEGIN:
   CIRC = 0
   BEFALL = 0
   NY = 63
   NIP = 31
   CF = 32
   K = 0
   DRAWLEVEL
START:
   IF SCENE = 7 AND X > 573 THEN VICTORY
   IF SCENE = 2 THEN GOSUB CANNON
   IF SCENE = 3 AND BEFALL = 0 AND X > 300 THEN GOSUB DROP
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN GOSUB DRCIRC
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19, PSET: NEXT: PUT (582, NIP), SPRITE19, PSET
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   PCOPY 1, 0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19: NEXT: PUT (582, NIP), SPRITE19
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
'IFS
   IF X > 573 THEN SCENE = SCENE + 1: CLS : ENEMY = 1: GOTO BEGIN
   IF Y < 30 THEN GOTO EXPLODE
   IF Y > 310 THEN GOTO EXPLODE
   IF ENEMY = 0 THEN GOTO MISS
   IF B < 30 THEN GOTO ENX
   IF B > 310 THEN GOTO ENX
   IF A < 20 THEN ENEMY = 0
MISS:
   GOSUB CHECKWALLS
'IFS
   IF ENEMY = 1 THEN GOSUB ENEMYMOVE
   LET A$ = INKEY$
   IF A$ = CHR$(27) THEN CHAIN "GAMEOVER.BAS"
   IF A$ = CHR$(0) + "H" THEN GOSUB MOVEUP
   IF A$ = CHR$(0) + "P" THEN GOSUB MOVEDN
   IF A$ = CHR$(0) + "M" THEN GOSUB MOVEFASTER
   IF A$ = CHR$(0) + "K" THEN GOSUB MOVESLOWER
   IF A$ <> "" THEN B$ = B$ + A$: PASSWORD
   X = X + FLYSTEP
   GOTO START
   END
MOVEUP:
   FOR MAKEIT = 1 TO 3
   Y = Y - 3
   A = A - FLYSTEP
   X = X + FLYSTEP
   IF SCENE = 2 THEN NY = NY + 8 / 5.0
   IF SCENE = 3 AND BEFALL = 0 AND X > 300 THEN NIP = NIP + 5 / 5.0
   IF SCENE = 5 AND CIRC = 0 AND X > 200 THEN CF = CF + 4 / 5.0
   IF ENEMY = 1 THEN B = B + K
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19, PSET: NEXT: PUT (582, NIP), SPRITE19, PSET
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   PCOPY 1, 0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19: NEXT: PUT (582, NIP), SPRITE19
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   NEXT
   RETURN
   END
MOVEDN:
   FOR MAKEIT = 1 TO 3
   Y = Y + 3
   X = X + FLYSTEP
   A = A - FLYSTEP
   IF SCENE = 3 AND BEFALL = 0 AND X > 300 THEN NIP = NIP + 5 / 5.0
   IF SCENE = 2 THEN NY = NY + 8 / 5.0
   IF ENEMY = 1 THEN B = B + K
   IF SCENE = 5 AND CIRC = 0 AND X > 200 THEN CF = CF + 4 / 5.0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19, PSET: NEXT: PUT (582, NIP), SPRITE19, PSET
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   PCOPY 1, 0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19: NEXT: PUT (582, NIP), SPRITE19
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   NEXT
   RETURN
   END
MOVEFASTER:
   IF FLYSTEP <> 2.5 / 5.0 THEN RETURN
   FOR MAKEIT = 1 TO 3
   X = X + FLYSTEP + 3
   A = A - FLYSTEP
   IF SCENE = 3 AND BEFALL = 0 AND X > 300 THEN NIP = NIP + 5 / 5.0
   IF SCENE = 2 THEN NY = NY + 8 / 5.0
   IF SCENE = 5 AND CIRC = 0 AND X > 200 THEN CF = CF + 4 / 5.0
   IF ENEMY = 1 THEN B = B + K
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19, PSET: NEXT: PUT (582, NIP), SPRITE19, PSET
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   PCOPY 1, 0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19: NEXT: PUT (582, NIP), SPRITE19
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   NEXT
   RETURN
   END
MOVESLOWER:
   IF FLYSTEP <> 2.5 / 5.0 THEN RETURN
   FOR MAKEIT = 1 TO 3
   X = X + FLYSTEP - 1.2 / 5.0
   A = A - FLYSTEP
   IF SCENE = 5 AND CIRC = 0 AND X > 200 THEN CF = CF + 4 / 5.0
   IF SCENE = 3 AND BEFALL = 0 AND X > 300 THEN NIP = NIP + 5 / 5.0
   IF SCENE = 2 THEN NY = NY + 8 / 5.0
   IF ENEMY = 1 THEN B = B + K
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19, PSET: NEXT: PUT (582, NIP), SPRITE19, PSET
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   PCOPY 1, 0
   PUT (X, Y), PLANE, XOR
   IF ENEMY = 1 THEN PUT (A, B), ENEMY, XOR
   IF SCENE = 2 THEN PUT (192, NY), SPRITE23: PUT (400, NY), SPRITE23: PUT (297, 350 - NY), SPRITE23
   IF SCENE = 3 AND BEFALL = 0 THEN FOR GI = 25 TO 550 STEP 112: PUT (GI, NIP), SPRITE19: NEXT: PUT (582, NIP), SPRITE19
   IF SCENE = 5 AND X > 200 AND CIRC = 0 THEN PUT (280, CF), SPRITE9
   NEXT
   RETURN
   END
CHECKWALLS:
   IF POWER = 1 THEN RETURN
   SCREEN , , 0, 0
   IF POINT(X, Y + 17) <> 0 THEN GOTO EXPLODE
   IF POINT(X + 18, Y) <> 0 THEN GOTO EXPLODE
   IF POINT(X + 18, Y + 34) <> 0 THEN GOTO EXPLODE
   IF POINT(X + 45, Y + 17) <> 0 THEN GOTO EXPLODE
   SCREEN , , 1, 0
   RETURN
   END
EXPLODE:
   SCREEN , , 0, 0
   FOR DI = 1 TO 20 STEP .1
   CIRCLE (X, Y + 10), DI, 4
   CIRCLE (X + 1, Y + 10), DI, 4
   CIRCLE (X + 20, Y + 20), DI, 4
   CIRCLE (X + 1 + 20, Y + 20), DI, 4
   CIRCLE (X + 20, Y), DI, 4
   CIRCLE (X + 1 + 20, Y), DI, 4
   NEXT
   FOR DI = 1 TO 20 STEP .1
   CIRCLE (X, Y + 10), DI, 0
   CIRCLE (X + 1, Y + 10), DI, 0
   CIRCLE (X + 20, Y + 20), DI, 0
   CIRCLE (X + 1 + 20, Y + 20), DI, 0
   CIRCLE (X + 20, Y), DI, 0
   CIRCLE (X + 1 + 20, Y), DI, 0
   NEXT
   LIFE = LIFE - 1
   IF LIFE < 1 THEN CHAIN "GAMEOVER.BAS"
   SCREEN , , 1, 0
   CLS
   ENEMY = 1
   GOTO BEGIN
   END
ENX:
   SCREEN , , 0, 0
   FOR DI = 1 TO 20 STEP .1
   CIRCLE (A, B + 10), DI, 4
   CIRCLE (A + 1, B + 10), DI, 4
   CIRCLE (A + 20, B + 20), DI, 4
   CIRCLE (A + 1 + 20, B + 20), DI, 4
   CIRCLE (A + 20, B), DI, 4
   CIRCLE (A + 1 + 20, B), DI, 4
   NEXT
   FOR DI = 1 TO 20 STEP .1
   CIRCLE (A, B + 10), DI, 0
   CIRCLE (A + 1, B + 10), DI, 0
   CIRCLE (A + 20, B + 20), DI, 0
   CIRCLE (A + 1 + 20, B + 20), DI, 0
   CIRCLE (A + 20, B), DI, 0
   CIRCLE (A + 1 + 20, B), DI, 0
   NEXT
   SCREEN , , 1, 0
   ENEMY = 0
   GOTO START
   END
ENEMYMOVE:
   K = 0
   FOR UA = A - 50 TO A
   IF POINT(UA, B) <> 0 THEN GOTO DOIT
   IF POINT(UA, B + 34) <> 0 THEN GOTO DOIT
   NEXT
CN:
   A = A - FLYSTEP
   B = B + K
   RETURN
   END
DOIT:
   FOR BO = 31 TO 348
   IF POINT(A - 50, BO) <> 0 AND BO > B THEN K = -6: GOTO CN
   IF POINT(A - 50, BO) <> 0 AND BO < B THEN K = 6: GOTO CN
   IF POINT(A - 50, BO) <> 0 AND BO = B THEN K = 0: GOTO CN
   NEXT
   GOTO CN
   END
CANNON:
   IF NY > 285 THEN NY = 63
   NY = NY + 8 / 5.0
   RETURN
   END
DROP:
   IF NIP > 270 THEN BEFALL = 1
   NIP = NIP + 5 / 5.0
   RETURN
   END
DRCIRC:
   IF CF > 290 THEN CIRC = 1
   CF = CF + 4 / 5.0
   RETURN
   END
   

SUB DRAWLEVEL
   LINE (0, 0)-(639, 30), 15, B
   LINE (5, 13)-(80, 28), 15, B
   LINE (550, 12)-(632, 28), 15, B
   PAINT (1, 1), 8, 15
   LINE (247, 13)-(392, 28), 15, B
   LOCATE 2, 2
   COLOR 14
   PRINT "LIVES:"; LIFE
   LOCATE 2, 70
   COLOR 14
   PRINT "SCENE:"; SCENE
   COLOR 15
   LOCATE 2, 32
   PRINT " TRICKS AND TRAPS "
SELECT CASE SCENE
CASE 1
   NOENEMY
   X = 0
   Y = 150
   PAINT (1, 300), 4, 15
   YR = 130
   PSET (XR, YR), 15
   FOR XR = 0 TO 640
   YR% = INT(RND * 4)
   IF YR% = 0 THEN DRAW "C15 R1"
   IF YR% = 1 THEN DRAW "C15 D1 R1"
   IF YR% = 2 THEN DRAW "C15 R1"
   IF YR% = 3 THEN DRAW "C15 U1 R1"
   NEXT
   YR = 280
   XR = 0
   PSET (XR, YR), 15
   FOR XR = 0 TO 640
   YR% = INT(RND * 2)
   IF YR% = 0 THEN DRAW "C15 U1 R1"
   IF YR% = 1 THEN DRAW "C15 D1 R1"
   NEXT
   PAINT (1, 180), 0, 15
   FOR XA = 0 TO 640 STEP 3
   FOR YA = 30 TO 350 STEP 3
   IF POINT(XA, YA) = 4 THEN PSET (XA, YA), 12
   NEXT
   NEXT
   LINE (0, 0)-(640, 30), 0, BF
   LINE (0, 0)-(639, 30), 15, B
   LINE (5, 13)-(80, 28), 15, B
   LINE (550, 12)-(632, 28), 15, B
   PAINT (1, 1), 8, 15
   LINE (247, 13)-(392, 28), 15, B
   LOCATE 2, 2
   COLOR 14
   PRINT "LIVES:"; LIFE
   LOCATE 2, 70
   COLOR 14
   PRINT "SCENE:"; SCENE
   COLOR 15
   LOCATE 2, 32
   PRINT " TRICKS AND TRAPS "
   FOR GI = 31 TO 300 STEP 44
   PUT (589, GI), SPRITE24, PSET
   NEXT
   PUT (589, 306), SPRITE24, PSET
   PUT (589, 163), SPRITE24, XOR
   PUT (589, 163), SPRITE26
CASE 2
   NOENEMY
   X = 0
   Y = 105
   FOR GI = 0 TO 600 STEP 26
   PUT (GI, 31), SPRITE27
   PUT (GI, 327), SPRITE27
   NEXT
   PUT (614, 31), SPRITE27, PSET
   PUT (614, 327), SPRITE27, PSET
   FOR GI = 54 TO 320 STEP 23
   PUT (0, GI), SPRITE27, PSET
   PUT (614, GI), SPRITE27, PSET
   NEXT
   PUT (0, 100), SPRITE27, XOR
   PUT (0, 123), SPRITE27, XOR
   PUT (614, 215), SPRITE27, XOR
   PUT (614, 238), SPRITE27, XOR
   PUT (182, 54), SPRITE28
   PUT (390, 54), SPRITE28
   PUT (286, 309), SPRITE29
   PUT (234, 54), SPRITE24
   PUT (234, 98), SPRITE24
   PUT (234, 142), SPRITE24
   PUT (468, 283), SPRITE24
   PUT (468, 239), SPRITE24
   PUT (468, 195), SPRITE24
CASE 3
   NOENEMY
   X = 0
   Y = 215
   FOR GI = 54 TO 320 STEP 23
   PUT (0, GI), SPRITE27, PSET
   NEXT
   PUT (0, 31), SPRITE27
   PUT (0, 327), SPRITE27, PSET
   PUT (0, 215), SPRITE27, XOR
   PUT (0, 238), SPRITE27, XOR
   FOR GI = 25 TO 550 STEP 112
   PUT (GI, 30), SPRITE19
   NEXT
   PUT (582, 30), SPRITE19
   FOR GI = 78 TO 550 STEP 112
   PUT (GI, 30), SPRITE2
   NEXT
CASE 4
   E2
   A = 593
   B = 200
   X = 0
   Y = 150
   FOR GI = 14 TO 570 STEP 61
   PUT (GI, 30), SPRITE3
   PUT (GI, 317), SPRITE3
   NEXT
   FOR GI = 95 TO 300 STEP 71
   PUT (120, GI), SPRITE3
   NEXT
   FOR GI = 65 TO 300 STEP 71
   PUT (250, GI), SPRITE3
   NEXT
   FOR GI = 108 TO 290 STEP 71
   PUT (400, GI), SPRITE3
   NEXT
   FOR GI = 100 TO 300 STEP 70
   PUT (580, GI), SPRITE9
   NEXT
CASE 5
   NOENEMY
   X = 0
   Y = 150
   FOR GI = 31 TO 150 STEP 45
   FOR BI = 200 TO 500 STEP 65
   PUT (BI, GI), SPRITE0
   PUT (BI, GI + 184), SPRITE0
   NEXT
   NEXT
CASE 6
   FLYSTEP = 4.5 / 5.0
   E1
   A = 593
   B = 150
   X = 0
   Y = 150
   PAINT (1, 300), 2, 15
   YR = 140
   PSET (XR, YR), 15
   FOR XR = 0 TO 640
   YR% = INT(RND * 4)
   IF YR% = 0 THEN DRAW "C15 R1"
   IF YR% = 1 THEN DRAW "C15 D1 R1"
   IF YR% = 2 THEN DRAW "C15 R1"
   IF YR% = 3 THEN DRAW "C15 U1 R1"
   NEXT
   YR = 270
   XR = 0
   PSET (XR, YR), 15
   FOR XR = 0 TO 640
   YR% = INT(RND * 2)
   IF YR% = 0 THEN DRAW "C15 U1 R1"
   IF YR% = 1 THEN DRAW "C15 D1 R1"
   NEXT
   PAINT (1, 180), 0, 15
   FOR XA = 0 TO 640 STEP 3
   FOR YA = 30 TO 350 STEP 3
   IF POINT(XA, YA) = 2 THEN PSET (XA, YA), 10
   NEXT
   NEXT
   LINE (0, 0)-(640, 30), 0, BF
   LINE (0, 0)-(639, 30), 15, B
   LINE (5, 13)-(80, 28), 15, B
   LINE (550, 12)-(632, 28), 15, B
   PAINT (1, 1), 8, 15
   LINE (247, 13)-(392, 28), 15, B
   LOCATE 2, 2
   COLOR 14
   PRINT "LIVES:"; LIFE
   LOCATE 2, 70
   COLOR 14
   PRINT "SCENE:"; SCENE
   COLOR 15
   LOCATE 2, 32
   PRINT " TRICKS AND TRAPS "
   PUT (200, 160), SPRITE24
   PUT (340, 220), SPRITE24
CASE 7
   FLYSTEP = 2.5 / 5.0
   NOENEMY
   X = 0
   Y = 150
   PUT (569, 70), SPRITE15
   PUT (480, 30), SPRITE4
   PUT (470, 189), SPRITE8
CASE ELSE
   X = 0
   Y = 150
   NOENEMY
   END SELECT
END SUB

SUB E1
  ENEMY = 1
  FOR DOENEMY = 0 TO 250
  ENEMY(DOENEMY) = ENEMY1(DOENEMY)
  NEXT
END SUB

SUB E2
  ENEMY = 1
  FOR DOENEMY = 0 TO 250
  ENEMY(DOENEMY) = ENEMY2(DOENEMY)
  NEXT
END SUB

SUB NOENEMY
  ENEMY = 0
END SUB

SUB PASSWORD
  IF LIFE = 9 THEN GOTO MISSIT
  IF INSTR(UCASE$(B$), "LIFE") <> 0 THEN LIFE = LIFE + 1: LOCATE 2, 2: COLOR 14: PRINT "LIVES:"; LIFE: B$ = ""
MISSIT:
  IF FLYSTEP > 6 THEN GOTO MISSOT
  IF INSTR(UCASE$(B$), "FAST") <> 0 THEN FLYSTEP = FLYSTEP + .5 / 5.0: B$ = ""
MISSOT:
  IF FLYSTEP = 1 THEN GOTO MISSTH
  IF INSTR(UCASE$(B$), "SLOW") <> 0 THEN FLYSTEP = FLYSTEP - .5 / 5.0: B$ = ""
MISSTH:
  IF INSTR(UCASE$(B$), "NEXT") <> 0 THEN SCENE = SCENE + 1: CLS :  B$ = "": DRAWLEVEL
  IF INSTR(UCASE$(B$), "-PAL") <> 0 THEN GOSUB GAMMA: B$ = ""
  IF INSTR(UCASE$(B$), "FULL") <> 0 THEN LIFE = 9: LOCATE 2, 2: COLOR 14: PRINT "LIVES:"; LIFE: B$ = ""
  IF INSTR(UCASE$(B$), "NULL") <> 0 THEN CLS : B$ = ""
  IF INSTR(UCASE$(B$), "E1") <> 0 THEN A = 585: B = 150: E1: B$ = ""
  IF INSTR(UCASE$(B$), "E2") <> 0 THEN A = 585: B = 150: E2: B$ = ""
  IF INSTR(UCASE$(B$), "GHOST") <> 0 THEN POWER = 1: B$ = ""
  IF INSTR(UCASE$(B$), "ALIVE") <> 0 THEN POWER = 0: B$ = ""
  IF INSTR(UCASE$(B$), "MAD") <> 0 THEN POWER = 1: FLYSTEP = 5.5 / 5.0: B$ = ""
  IF INSTR(UCASE$(B$), "CALM") <> 0 THEN POWER = 0: FLYSTEP = 2.5 / 5.0: B$ = ""
  IF INSTR(UCASE$(B$), "MSG") <> 0 THEN LOCATE 2, 33: COLOR 15: PRINT "YOU'LL NEVER WIN": B$ = ""
  IF INSTR(UCASE$(B$), "WIN") <> 0 THEN VICTORY: B$ = ""
  GOTO ENDIT
GAMMA:
  FOR AB = 1 TO 10
  FOR CB = 0 TO 255
  OUT &H3C7, CB: RB = INP(&H3C9): GB = INP(&H3C9): BB = INP(&H3C9)
  IF RB > 0 THEN RB = RB - 1
  IF GB > 0 THEN GB = GB - 1
  IF BB > 0 THEN BB = BB - 1
  OUT &H3C8, CB: OUT &H3C9, RB: OUT &H3C9, GB: OUT &H3C9, BB
  NEXT CB
  NEXT AB
  RETURN
ENDIT:
END SUB

SUB VICTORY
  SCREEN , , 0, 0
  PUT (220, 170), LEND, PSET
  FOR CYCLE = 1 TO FLYSTEP * 150000
  NEXT
  RUN "E1L5.BAS"
END SUB

